# Datasets {#appendix:datasets}

<!-- (C) 2020 Marek Gagolewski, https://www.gagolewski.com -->



Below we briefly describe the most noteworthy
datasets considered in this book.
They are available for download at
https://github.com/gagolews/lmlcr/tree/master/datasets.
Many of them are real-world data, and need some proper cleaning,
outlier removal etc. Moreover, for some of them, the machine learning
models studied will not be of the highest quality. That's life.


"Good" datasets are actually hard to find!
Many books analyse datasets that are "too easy"; they give their readers
the false impression that anything can be modelled well with machine learning
algorithms. Most often, you will be dealing with datasets that are incapable
of telling any interesting story. Fear not, this is not personal,
you are not stupid if you cannot find any useful pattern in your data!
You might be forced
(by your thesis supervisor, manager, client,
you-the-utterly-ambitious-yourself that wants to prove your point, get
that paper published, show off your superb data science skills in front
of your workmates etc.) to squeeze something out of it anyway.
If but few tear drops are really there,
communicating this openly should be part of your work ethics.




Remark.

: The files with the `.csv.gz` extension are CSVs compressed with
`gzip` (a widespread, open source format).
R is able to decompress them on-the-fly when we use, e.g., `read.csv()`.




Compatibility note.

: We recommend that you use R version 4.0 or later. If this is not the case,
please issue `options(stringsAsFactors=FALSE)` at the beginning
of each R session or add the `stringsAsFactors=FALSE` argument
to each call to `read.csv()`, `data.frame()` etc.
Otherwise,




## Sustainable Society Indices


Van de Kerk and Manuel in [@ssi], by extending
the famous definition from the "Brundtland Report"
[@brundtland_report], proclaim that:

> *A sustainable society is a society that:*
>
> * *meets the needs of the present generation,*
> * *does not compromise the ability of future generations to meet their own needs,*
> * *in which each human being has the opportunity to develop itself in freedom,
>   within a well-balanced society and in harmony with its surroundings.*

In 2006 they have established the Sustainable Society Foundation,
headquartered in the Netherlands,
with the objective to develop the Sustainable Society Indices whose
aim is to aid in answering the question of "How sustainable is your country?".


`ssi_2016_* `           |
------------------------|---------------------------------------------
Last updated            | December 2016
Provider                | Sustainable Society Foundation
License                 | Public Domain
Source                  | http://www.ssfindex.com/



The most recent, 2016, edition of SSI includes 21 indicators that are based
on publicly available data (UNESCO, FAO etc.).
Raw scores (such as CO2 emissions per capita, life expectancy at birth
or the ratio of income of the richest 10% to the poorest 10% citizens)
have been transformed onto the 0-10 scale by means of the formulas explained in detail
in http://www.ssfindex.com/ssi2016/wp-content/uploads/pdf/calculation-formulas-2016.pdf

The 21 fine-grained indicators can be aggregated (by means of the geometric mean)
into 7 categories, which in turn form 3 dimensions:


* Human Wellbeing

    a. Basic Needs
        1. Sufficient Food
        2. Sufficient to Drink
        3. Safe Sanitation

    b. Personal Development and Health

        4. Education
        5. Healthy Life
        6. Gender Equality

    c. Well-balanced Society

        7. Income Distribution
        8. Population Growth
        9. Good Governance

* Environmental Wellbeing

    d. Natural Resources

        10. Biodiversity
        11. Renewable Water Resources
        12. Consumption

    e. Climate and Energy

        13. Energy Use
        14. Energy Savings
        15. Greenhouse Gases
        16. Renewable Energy

* Economic Wellbeing

    f. Transition

        17. Organic Farming
        18. Genuine Savings

    g. Economy

        19. GDP
        20. Employment
        21. Public Debt

All the indices are explained in very detail in the whitepapers
and reports available at http://www.ssfindex.com/ssi/calculation-methodology/.



```{r ssi_indicators}
ssi_indicators <- read.csv("datasets/ssi_2016_indicators.csv",
    comment.char="#")
head(ssi_indicators, 3)
```

```{r ssi_categories}
ssi_categories <- read.csv("datasets/ssi_2016_categories.csv",
    comment.char="#")
head(ssi_categories, 3)
```

```{r ssi_dimensions}
ssi_dimensions <- read.csv("datasets/ssi_2016_dimensions.csv",
    comment.char="#")
head(ssi_dimensions, 3)
```




## Air Quality

Environment Protection Authority of the state of Victoria, Australia
published the 2018 air quality data on its Open Data platform.
Various parameters are probed at different spots on an hourly basis.

`air_quality`        |
---------------------|---------------------------------------------
Last updated         | 22 May 2019
Provider             | Environment Protection Authority Victoria
License              | Creative Commons Attribution 4.0 International License
Source               | https://discover.data.vic.gov.au/dataset/epa-air-watch-all-sites-air-quality-hourly-averages-yearly


<!-- Terms of use:

https://www.data.vic.gov.au/about-datavic

https://discover.data.vic.gov.au/dataset/epa-air-watch-all-sites-air-quality-hourly-averages-yearly
-- Creative Commons Attribution 4.0 International


-->




```{r datasets_air1}
air_quality <- read.csv("datasets/air_quality.csv.gz",
    comment.char="#")
head(air_quality, 3)
```



Column                         | Description
-------------------------------|---------------------------------------------
`sample_point_id`              | Integer identifier of the sample point
`sp_name`                      | Sample point name (city, suburb etc.)
`latitude`                     |
`longitude`                    |
`sample_datetime`              | Date and time of the measurement; DD/MM/YYYY HH:MM:SS local time
`time_basis_id`                | Denotes whether a 1-hour or 24-hour average is provided (`r paste(unique(air_quality$time_basis_id), collapse=", ")`)
`param_id`                     | Identifier of the air quality parameter: `r paste(unique(air_quality$param_id), collapse=", ")`
`param_name`                   | Name of the parameter: `r paste(unique(air_quality$param_name), collapse=", ")`
`value`                        | Measured parameter value
`param_std_unit_of_measure`    | Unit of measure
`param_short_name`             | Short version of the parameter name:  `r paste(unique(air_quality$param_short_name), collapse=", ")`








## Currency Exchange Rates

Statistical Data Warehouse of the European Central Bank System
publishes currency exchange rates (quoted against EUR)
that are updated once per working day.

The column names give the traditional ISO 4217 currency designators
(see Table below), for instance JPY stands for the Japanese (JP)
yen.

In each column like `YYY`, the quotation (EUR/YYY) is listed,
giving the price of the Euro (here: the base currency)
expressed in the  counter/quote currency YYY,
e.g., the value of 118.0 in JPY means that 1 euro = 118 yens.



`currency_exchange`  |
---------------------|---------------------------------------------------
Last updated         | 19 May 2020
Provider             | European Central Bank
License              | Provided free of charge to enhance public access to information about the activities of the European Central Bank System and the activities of the European System of Central Banks
Source               | http://sdw.ecb.europa.eu/browse.do?node=9691296


<!-- Terms of use:

https://www.ecb.europa.eu/home/disclaimer/html/index.en.html

Copyright © for the entire content of this website: European Central Bank, Frankfurt am Main, Germany.

Subject to the exception below, users of this website may make free use of the information obtained directly from it subject to the following conditions:

    When such information is distributed or reproduced, it must appear accurately and the ECB must be cited as the source.
    Where the information is incorporated in documents that are sold (regardless of the medium), the natural or legal person publishing the information must inform buyers, both before they pay any subscription or fee and each time they access the information taken from this website, that the information may be obtained free of charge through this website.
    If the information is modified by the user (e.g. by seasonal adjustment of statistical data or calculation of growth rates) this must be stated explicitly.
    When linking to this website from business sites or for promotional purposes, this website must load into the browser's entire window (i.e. it must not appear within another website's frame).




-->


```{r datasets_rates}
currency_exchange <- read.csv("datasets/currency_exchange_all.csv.gz",
    comment.char="#")
# convert Day to Date-type object:
currency_exchange$Day <- as.Date(currency_exchange$Day)
head(currency_exchange, 2)
```






Column          | Description
----------------|---------------------------------------------
`Day`           |    Date in YYYY-MM-DD format, from `r min(currency_exchange$Day)` to `r max(currency_exchange$Day)`, ordered decreasingly
`AUD`           |    Australian dollar
`BGN`           |    Bulgarian lev
`BRL`           |    Brazilian real
`CAD`           |    Canadian dollar
`CHF`           |    Swiss franc
`CNY`           |    Chinese yuan renminbi
`CZK`           |    Czech koruna
`DKK`           |    Danish krone
`GBP`           |    UK pound sterling
`HKD`           |    Hong Kong dollar
`HRK`           |    Croatian kuna
`HUF`           |    Hungarian forint
`IDR`           |    Indonesian rupiah
`ILS`           |    Israeli shekel
`INR`           |    Indian rupee
`ISK`           |    Iceland krona
`JPY`           |    Japanese yen
`KRW`           |    Korean won
`MXN`           |    Mexican peso
`MYR`           |    Malaysian ringgit
`NOK`           |    Norwegian krone
`NZD`           |    New Zealand dollar
`PHP`           |    Philippine peso
`PLN`           |    Polish zloty
`RON`           |    Romanian leu
`RUB`           |    Russian rouble
`SEK`           |    Swedish krona
`SGD`           |    Singapore dollar
`THB`           |    Thai baht
`TRY`           |    Turkish lira
`USD`           |    US dollar
`ZAR`           |    South African rand



From this dataset we derive two following ones.

`currency_exchange_single`.

: The EUR/AUD rates only, from the least to the most recent:


    ```{r datasets_rates2,eval=FALSE}
    write.table(rev(currency_exchange$AUD),
        "datasets/currency_exchange_single.csv",
        col.names=FALSE, row.names=FALSE, quote=FALSE)
    ```


`currency_exchange_diff`.

:   Relative daily changes
    in the EUR/AUD rates (we use it for building example
    exchange rates prediction algorithms):


    ```{r datasets_rates3}
    n <- nrow(currency_exchange)
    pred <- currency_exchange[n:1, c("Day", "AUD")] # from oldest to newest
    row.names(pred) <- NULL # reset the row.names attribute
    pred$Change <- NA
    pred$Change[2:n] <- diff(pred$AUD) # iterative difference:
        # pred$Change[2] == pred$AUD[2]-pred$AUD[1], ...,
        # pred$Change[n] == pred$AUD[n]-pred$AUD[n-1]
    pred$Dir <- as.character(cut(pred$Change, c(-Inf, 0, Inf),
        c("dec", "inc"))) # inc if Change is positive, dec otherwise
    for (k in 1:10) {
        name <- paste0("Lag", k)
        pred[[name]] <- NA
        pred[[name]][(k+1):n] <- pred$Change[1:(n-k)]
    }
    tail(pred)
    ```


    Note that `pred$Change[i]` gives by how much the exchange rate
    changed as compared to the previous day, i.e., it is equal to
    `pred$AUD[i]-pred$AUD[i-1]`. `Lag1` is the change from the preceding
    working day, `Lag2` is the one from 2 working days ago, etc.


    ```{r datasets_rates4,eval=FALSE}
    write.csv(pred, "datasets/currency_exchange_diff.csv.gz",
       row.names=FALSE)
    ```




## Urban Forest

The Urban Forest dataset gives location, species and lifespan of
ca. 72,500 trees in Melbourne, VIC, Australia.


`urban_forest` |
---------------|------------------------------------------------------------------
Last updated   | 10 March 2020
Provider       | City of Melbourne
License        | Creative Commons Attribution 4.0 International Public License
Source         | https://data.melbourne.vic.gov.au/Environment/Trees-with-species-and-dimensions-Urban-Forest-/fp38-wiyy

<!-- Terms of use:

https://data.melbourne.vic.gov.au/stories/s/data-principles/9f8u-v2fn

https://data.melbourne.vic.gov.au/Environment/Trees-with-species-and-dimensions-Urban-Forest-/fp38-wiyy
-- CC Attribution 4.0

-->



```{r datasets_forest}
urban_forest <- read.csv("datasets/urban_forest.csv.gz",
    comment.char="#")
head(urban_forest, 3)
```



Column                         | Description
-------------------------------|---------------------------------------------
`CoM.ID`                       | City of Melbourne's unique asset ID
`Common.Name`                  |
`Scientific.Name`              |
`Genus`                        |
`Family`                       |
`Diameter.Breast.Height`       | Diameter at breast height is a standard method of expressing the diameter of the trunk or bole of a standing tree. City of Melbourne Measures this 1.4m from ground level. 0.00 = Not yet assessed
`Year.Planted`                 | This is generally accurate for trees planted from 2003 onward, prior to 2003 this indicate the date the trees are added to the inventory.
`Date.Planted`                 | See above.
`Age.Description`              | Based on date planted/data entry, therefore sometimes inaccurate; Null value = Not yet assessed
`Useful.Life.Expectancy`       | The trees useful life expectancy. Last updated in 2009; Null value = Not yet assessed
`Useful.Life.Expectancy.Value` | Useful Life Expectancy Value, derived from the Useful Life Expectancy column, displayed as an integer
`Precinct`                     | The neighbourhood boundary defined for tree planning purposes
`Located.In`                   | This describes whether a tree is located within a public park or along a street
`Upload.Date`                  |
`Coordinate.Location`          |
`Latitude`                     |
`Longitude`                    |
`Easting`                      | Easting Coordinate, please use MGA94-55
`Northing`                     | Northing Coordinate, please use MGA94-55



## Wine Quality

The Wine Quality dataset [@wines]
describes 11 physicochemical features of Vinho Verde wine samples
from the Minho region in northwest Portugal.
Moreover, there are wine ratings given by wine experts and their colour.

`wine_quality`  |
----------------|------------------------------------------------------------------
Last updated    | 2009
Provider        | Paulo Cortez, Antonio Cerdeira, Fernando Almeida, Telmo Matos and Jose Reis via UCI [@uci]
License         | Public Domain
Source          | http://archive.ics.uci.edu/ml/datasets/Wine+Quality


<!-- Terms of use:

Donated by Paulo Cortez to UCI, public domain

-->





```{r dataset_wine_quality}
wine_quality <- read.csv("datasets/wine_quality_all.csv",
    comment.char="#")
head(wine_quality, 3)
```



Column                         | Description
-------------------------------|---------------------------------------------
`fixed.acidity`                |  (g(tartaric acid)/dm³)
`volatile.acidity`             |  (g(acetic acid)/dm³)
`citric.acid`                  |  (g/dm³)
`residual.sugar`               |  (g/dm³)
`chlorides`                    |  (g(sodium chloride)/dm³)
`free.sulfur.dioxide`          |  (mg/dm³)
`total.sulfur.dioxide`         |  (mg/dm³)
`density`                      |  (g/cm³)
`pH`                           |
`sulphates`                    |  (g(potassium sulphate)/dm³)
`alcohol`                      |  (vol.%)
`response`                     |  Wine rating on the scale 0 (bad) to 10 (excellent): median of at least 3 valuations by sensory assessors
`color`                        |  Wine colour: `red` (1599) or `white` (4898)



`wine_train`, `wine_test`.

:   In the first chapters we want to set up a working classifier as
    fast as possible, without going into details on why and how to perform
    a train-test split etc. Therefore, let's prepare a tailored subset
    of the wine quality database.

    First, we select 500 white wines at random:

    ```{r wine_train_test_split1}
    set.seed(1234) # reproducibility matters
    wine_subset <- wine_quality[wine_quality$color=="white",]
    wine_subset <- wine_subset[sample(nrow(wine_subset), 500),]
    ```

    Next we create a new column that tells us whether
    a given wine is bad (class 1, quality is not greater than 5)
    or not-bad:

    ```{r wine_train_test_split2}
    wine_subset$bad <- as.numeric(wine_subset$response <= 5)
    ```

    For simplicity, we are  only interested in 5 following physicochemical
    features:

    ```{r wine_train_test_split3}
    wine_subset <- wine_subset[, c(
        "alcohol", "volatile.acidity", "chlorides",
        "free.sulfur.dioxide", "total.sulfur.dioxide", "bad"
    )]
    ```

    Then we perform a 60/40% split. The rows in the data frame
    are already randomised, therefore the first 300 can constitute
    the training sample and the remaining 200  can define the test sample.

    ```{r wine_train_test_split4,eval=FALSE}
    write.csv(wine_subset[1:300, ],
        "datasets/wine_train.csv", row.names=FALSE)
    write.csv(wine_subset[-(1:300), ],
        "datasets/wine_test.csv", row.names=FALSE)
    ```


## The World Factbook (Countries of the World)


The World Factbook 2020 dataset consists of country names, their population,
area, GDP, mortality rates etc.


`world_factbook`|
----------------|------------------------------------------------------------------
Last updated    | 3 April 2020
Provider        | Central Intelligence Agency
License         | Public Domain
Source          | https://www.cia.gov/library/publications/resources/the-world-factbook/index.html


<!-- Terms of use:

https://www.cia.gov/library/publications/the-world-factbook/docs/faqs.html:
The World Factbook is in the public domain and may be used freely by anyone
at anytime without seeking permission. However, US Code (Section 403m)
prohibits use of the CIA seal in a manner which implies that the CIA
approved, endorsed, or authorized such use. For any questions about
your intended use, you should consult with legal counsel. Further
information on use of The World Factbook is described on the Contributors
and Copyright Information page. As a courtesy, please cite The World
Factbook when used.

Terms of Use: https://www.cia.gov/library/publications/the-world-factbook/docs/contributor_copyright.html

The Factbook is in the public domain. Accordingly, it may be copied freely without permission of the Central Intelligence Agency (CIA).

-->


```{r factbookA1}
factbook <- read.csv("datasets/world_factbook_2020.csv",
    comment.char="#")
factbook[1:6, 1:5] # preview
```

Column                                               | Description
-----------------------------------------------------|---------------------------------------------
`country`                                            | Country name
`area`                                               | Area (km²) as the sum of all land and water areas delimited by international boundaries and/or coastlines.
`population`                                         | Population
`median_age`                                         | Median age of population in years.
`population_growth_rate`                             | Compares the average annual % change in populations, resulting from a surplus (or deficit) of births over deaths and the balance of migrants entering and leaving a country.
`birth_rate`                                         | Annual number of births/1,000 population
`death_rate`                                         | Annual number of deaths/1,000 population
`net_migration_rate`                                 | Difference between the annual number of persons entering and leaving a country/1,000 population
`maternal_mortality_rate`                            | Annual number of female deaths/100,000 live births from any cause related to or aggravated by pregnancy or its management (excluding accidental or incidental causes)
`infant_mortality_rate`                              | Annual number of deaths of infants under one year old/1,000 live births
`life_expectancy_at_birth`                           | Average number of years to be lived by a group of people born in the same year
`total_fertility_rate`                               | Average number of children per woman (if all women lived to the end of their childbearing years)
`hiv_aids_adult_prevalence_rate`                     | % adults (aged 15-49) living with HIV/AIDS
`hiv_aids_people_living_with`                        | Number of people living with HIV/AIDS
`hiv_aids_deaths`                                    | The number of adults and children who died of AIDS during a calendar year
`obesity_adult_prevalence_rate`                      | % population considered to be obese
`children_under_age_5_underweight`                   | % children under 5 years considered to be underweight
`education_expenditures`                             | Public expenditure on education as % GDP
`unemployment_youth_ages_15_to_24`                   | % total labour force aged 15-24 that are unemployed
`gdp_purchasing_power_parity`                        | Gross domestic product (GDP) on a purchasing power parity (PPP) basis, i.e., the sum value of all goods and services produced in the country valued at prices prevailing in the United States (USD)
`gdp_real_growth_rate`                               | Annual % GDP growth adjusted for inflation
`gdp_per_capita_ppp`                                 | GDP on PPP divided by population
`gross_national_saving`                              | Gross national disposable income minus final consumption expenditure as % GDP
`industrial_production_` `growth_rate`               | Annual % increase in industrial production (includes manufacturing, mining and construction)
`labor_force`                                        | Total labour force
`unemployment_rate`                                  | % labour force that is without jobs
`taxes_and_other_revenues`                           | Total taxes and other revenues received by the national government as % GDP
`budget_surplus_or_deficit`                          | Difference between national government revenues and expenditures as % GDP
`public_debt`                                        | Cumulative total of all government borrowings minus spending as % GDP
`inflation_rate_consumer_prices`                     | Annual % change in consumer prices
`current_account_balance`                            | Net trade in goods and services plus net earnings and net transfer payments to/from the rest of the world (USD)
`exports`                                            | Total amount of merchandise exports (USD)
`imports`                                            | Total amount of merchandise imports (USD)
`reserves_of_foreign_` `exchange_and_gold`           | Financial assets that are available to the central monetary authority (USD)
`debt_external`                                      | Total public and private debt owed to nonresidents (USD)
`electricity_production`, `_consumption`, `_exports`, `_imports` | Electricity produced, consumed, exported and imported (kWh)
`electricity_installed_` `generating_capacity`       | Total capacity of currently installed generators to produce electricity (kW)
`electricity_from_` `fossil_fuels`                   | Capacity of plants that generate electricity by burning fossil fuels (coal, petroleum products  and natural gas) as % total installed capacity
`electricity_from_` `nuclear_fuels`                  | Capacity of plants that generate electricity through radioactive decay of nuclear fuel as % total installed capacity
`electricity_from_` `hydroelectric_plants`           | Capacity of plants that generate electricity by water-driven turbines as % total installed capacity
`electricity_from_` `other_renewable_sources`        | Capacity of plants that generate electricity by using renewable energy sources other than hydroelectric (wind, waves, solar, geothermal) as % total installed capacity
`crude_oil_production`, `_exports`, `_imports`       | Crude oil produced, exported and imported (barrels per day)
`crude_oil_proved_reserves`                          | Stock of proved reserves of crude oil (barrels)
`refined_petroleum_products_` `production`, `_consumption`, `_exports`, `_imports` | Refined petroleum products produced, consumed, exported and imported (barrels per day)
`natural_gas_production`, `_consumption`, `_exports`, `_imports` | Natural gas produced, consumed, exported and imported (m³)
`natural_gas_proved_reserves`                        | Proved reserves of natural gas (m³)
`carbon_dioxide_emissions_` `from_consumption_of_energy`| Total amount of carbon dioxide (in metric tons) released by burning fossil fuels in the process of producing and consuming energy
`telephones_fixed_lines`                             | Total number of main telephone lines in use
`telephones_mobile_cellular`                         | Total number of mobile cellular telephone subscribers
`internet_users`                                     | Number of users that access the Internet
`broadband_fixed_subscriptions`                      | Total number of broadband internet subscribers
`military_expenditures`                              | Spending on defence programs as % GDP
`airports`                                           | Total number of airports or airfields recognisable from the air
`railways`                                           | Total route length of the railway network and of its component parts (km)
`roadways`                                           | Total length of the road network (km)
`waterways`                                          | Total length of navigable rivers, canals and other inland bodies of water (km)
`merchant_marine`                                    | Number of ships engaged in the carriage of goods





## EdStats (Country-Level Education Statistics)

The file `edstats_2019.csv.gz` provides us with many
country-level Education Statistics extracted from the World Bank's Databank.
Databank aggregates information from such sources as
the UNESCO Institute for Statistics,
OECD Programme for International Student Assessment (PISA)
etc. The official description reads:

> "The World Bank EdStats Query holds around 2,500 internationally comparable
education indicators for access, progression, completion, literacy, teachers,
population, and expenditures. The indicators cover the education cycle from
pre-primary to tertiary education. The query also holds learning outcome data
from international learning assessments (PISA, TIMSS, etc.), equity data
from household surveys, and projection data to 2050."


`edstats`       |
----------------|------------------------------------------------------------------
Last updated    | 24 April 2020
Provider        | The World Bank's Databank
License         | Creative Commons Attribution 4.0 International License (CC BY 4.0)
Source          | https://databank.worldbank.org/

<!-- Terms of use:

https://www.worldbank.org/en/about/legal/terms-of-use-for-datasets

You are encouraged to use the Datasets to benefit yourself and others in creative ways. You may extract, download, and make copies of the data contained in the Datasets, and you may share that data with third parties according to these terms of use.

Unless specifically labeled otherwise, these Datasets are provided to you under a Creative Commons Attribution 4.0 International License (CC BY 4.0),

-->



```{r edstats_wide_1}
edstats_2019 <- read.csv("datasets/edstats_2019.csv.gz",
    comment.char="#")
head(edstats_2019)
```

This data frame is in a "long" format, where each indicator
for each country is given in its own row. Note that we extracted
the indicators reported between 2010 and 2019 and that some of them
are not surveyed/updated every year.




`edstats_2019_wide`.

: Let's convert this dataset to the "wide" format (one row per country,
each indicator in its own column) based on the most recent indicators.

First we need a function that returns the last non-missing value in a
given numeric vector.
To recall, `na.omit()`, removes all missing values and `tail()` can be
used to access the last observation easily. Unfortunately, if the vector
is consists of missing values only, the removal of `NA`s leads
to an empty sequence. However, the trick we can use is that
by extracting the first element from an empty vector by using
`[...]`, we get a `NA`.


```{r edstats_wide_2}
last_non_na <- function(x) tail(na.omit(x), 1)[1]
last_non_na(c(1, 2, NA, 3,NA,NA)) # example 1
last_non_na(c(NA,NA,NA,NA,NA,NA)) # example 2
```

Let's extract the most recent indicator from each row in `edstats_2019`.

```{r edstats_wide_3}
values <- apply(edstats_2019[-(1:4)], 1, last_non_na)
head(values)
```

Now, we shall create a data frame with 3 columns:
name of the country, indicator code, indicator value.
Let's order it with respect to the first two columns.

```{r edstats_wide_4}
edstats_2019 <- edstats_2019[c("CountryName", "Code")]
# add a new column at the righthand end:
edstats_2019["Value"] <- values
edstats_2019 <- edstats_2019[
    order(edstats_2019$CountryName, edstats_2019$Code), ]
head(edstats_2019)
```


To convert the data frame to a "wide" format, many readers would choose
the `pivot_wider()` function from the `tidyr` package
(amongst others).


```{r edstats_wide_5}
library("tidyr")
edstats <- as.data.frame(
    pivot_wider(edstats_2019, names_from="Code", values_from="Value")
)
edstats[1, 1:7]
```


Side note (\*).

:   The above solution is of course perfectly fine
    and we can now live long and prosper.
    Nevertheless, we are here to learn new skills, so let's note
    that it has the drawback that it required
    us to search for the answer on the internet (and go through many "answers"
    that actually don't work). If we are not converting between the long and the
    wide formats on a daily basis, this might not be worth the hassle
    (moreover, there's no guarantee that this function will work the same
    way in the future, that the package we relied on will provide the same API etc.).

    Instead, by relaying on a bit deeper knowledge of R programming
    (which we already have gained, see Appendices \@ref(appendix:rvector),
     \@ref(appendix:rmatrix) and  \@ref(appendix:rdf)),
    we could implement the relevant procedure manually. The downside is that
    this requires us to get out of our comfort zone and... think.

    First, let's generate the list of all countries and indicators:

    ```{r edstats_wide_6}
    countries  <- unique(edstats_2019$CountryName)
    head(countries)
    indicators <- unique(edstats_2019$Code)
    head(indicators)
    ```

    Second, note that `edstats_2019` gives all the possible combinations (pairs)
    of the indexes and countries:

    ```{r edstats_wide_7}
    nrow(edstats_2019) # number of rows in edstats_2019
    length(countries)*length(indicators) # number of pairs
    ```

    Looking at the numbers in the `Value` column of `edstats_2019`,
    this will exactly provide us with our desired "wide" data matrix,
    if we read it in a rowwise manner. Hence, we can use
    `matrix(..., byrow=TRUE)` to generate it:

    ```{r edstats_wide_8}
    # edstats_2019 is already sorted w.r.t. CountryName and Code
    edstats2 <- cbind(
        CountryName=countries, # first column
        as.data.frame(
            matrix(edstats_2019$Value,
                byrow=TRUE,
                ncol=length(indicators),
                dimnames=list(NULL, indicators)
        )))
    identical(edstats, edstats2)
    ```



Now we can export `edstats` to a CSV file.

```{r edstats_wide_9,eval=FALSE}
write.csv(edstats, "datasets/edstats_2019_wide.csv", row.names=FALSE)
```

We didn't export the row names, because they're useless in our case.




. . .

The table below lists the indicators included in `edstats_2019_wide.csv`
based on their description included in
`Series` column of the accompanying `edstats_meta.csv` file.
For more details, refer to the `Definition`, `Source`, `Topic` columns therein.



```{r  edstats_wide_99,echo=FALSE,results="asis",eval=FALSE}
meta <- read.csv("datasets/edstats_meta.csv")
for (i in 1:nrow(meta))
    cat(sprintf("%-50s | %s\n", meta$Code[i], meta$Series[i]))
```



Column                          | Description
--------------------------------|---------------------------------------------
`CountryName`                   | Country
`HD.HCI.AMRT`                   | Human Capital Index (HCI): Survival Rate from Age 15-60, Total
`HD.HCI.AMRT.FE`                | Human Capital Index (HCI): Survival Rate from Age 15-60, Female
`HD.HCI.AMRT.MA`                | Human Capital Index (HCI): Survival Rate from Age 15-60, Male
`HD.HCI.EYRS`                   | Human Capital Index (HCI): Expected Years of School, Total
`HD.HCI.EYRS.FE`                | Human Capital Index (HCI): Expected Years of School, Female
`HD.HCI.EYRS.MA`                | Human Capital Index (HCI): Expected Years of School, Male
`HD.HCI.HLOS`                   | Harmonised Test Scores, Total
`HD.HCI.HLOS.FE`                | Harmonised Test Scores, Female
`HD.HCI.HLOS.MA`                | Harmonised Test Scores, Male
`HD.HCI.MORT`                   | Human Capital Index (HCI): Probability of Survival to Age 5, Total
`HD.HCI.MORT.FE`                | Human Capital Index (HCI): Probability of Survival to Age 5, Female
`HD.HCI.MORT.MA`                | Human Capital Index (HCI): Probability of Survival to Age 5, Male
`HD.HCI.OVRL`                   | Human Capital Index (HCI) Score: Total (Scale 0-1)
`HD.HCI.OVRL.FE`                | Human Capital Index (HCI) Score: Female (Scale 0-1)
`HD.HCI.OVRL.MA`                | Human Capital Index (HCI) Score: Male (Scale 0-1)
`IT.CMP.PCMP.P2`                | Personal computers/100 people
`IT.NET.USER.P2`                | Internet users/100 people
`LO.PISA.MAT`                   | PISA: Mean performance on the mathematics scale
`LO.PISA.MAT.FE`                | PISA: Mean performance on the mathematics scale. Female
`LO.PISA.MAT.MA`                | PISA: Mean performance on the mathematics scale. Male
`LO.PISA.REA`                   | PISA: Mean performance on the reading scale
`LO.PISA.REA.FE`                | PISA: Mean performance on the reading scale. Female
`LO.PISA.REA.MA`                | PISA: Mean performance on the reading scale. Male
`LO.PISA.SCI`                   | PISA: Mean performance on the science scale
`LO.PISA.SCI.FE`                | PISA: Mean performance on the science scale. Female
`LO.PISA.SCI.MA`                | PISA: Mean performance on the science scale. Male
`NY.GDP.MKTP.CD`                | GDP (current USD)
`NY.GDP.PCAP.CD`                | GDP per capita (current USD)
`NY.GDP.PCAP.PP.CD`             | GDP per capita, PPP (current international dollars)
`NY.GNP.PCAP.CD`                | GNI per capita, Atlas method (current USD)
`NY.GNP.PCAP.PP.CD`             | GNI per capita, PPP (current international dollars)
`SE.COM.DURS`                   | Duration of compulsory education (years)
`SE.PRM.CMPT.ZS`                | Primary completion rate, both sexes (%)
`SE.PRM.CMPT.FE.ZS`             | Primary completion rate, female (%)
`SE.PRM.CMPT.MA.ZS`             | Primary completion rate, male (%)
`SE.PRM.ENRL.TC.ZS`             | Pupil-teacher ratio in primary education (headcount basis)
`SE.PRM.ENRR`                   | Gross enrolment ratio, primary, both sexes (%)
`SE.PRM.ENRR.FE`                | Gross enrolment ratio, primary, female (%)
`SE.PRM.ENRR.MA`                | Gross enrolment ratio, primary, male (%)
`SE.PRM.NENR`                   | Net enrolment rate, primary, both sexes (%)
`SE.PRM.NENR.FE`                | Net enrolment rate, primary, female (%)
`SE.PRM.NENR.MA`                | Net enrolment rate, primary, male (%)
`SE.PRM.PRIV.ZS`                | Percentage of enrolment in primary education in private institutions (%)
`SE.SEC.ENRL.TC.ZS`             | Pupil-teacher ratio in secondary education (headcount basis)
`SE.SEC.ENRR`                   | Gross enrolment ratio, secondary, both sexes (%)
`SE.SEC.ENRR.FE`                | Gross enrolment ratio, secondary, female (%)
`SE.SEC.ENRR.MA`                | Gross enrolment ratio, secondary, male (%)
`SE.SEC.NENR`                   | Net enrolment rate, secondary, both sexes (%)
`SE.SEC.NENR.MA`                | Net enrolment rate, secondary, male (%)
`SE.SEC.PRIV.ZS`                | Percentage of enrolment in secondary education in private institutions (%)
`SE.TER.ENRR`                   | Gross enrolment ratio, tertiary, both sexes (%)
`SE.TER.ENRR.FE`                | Gross enrolment ratio, tertiary, female (%)
`SE.TER.ENRR.MA`                | Gross enrolment ratio, tertiary, male (%)
`SE.TER.PRIV.ZS`                | Percentage of enrolment in tertiary education in private institutions (%)
`SE.XPD.TOTL.GD.ZS`             | Government expenditure on education as % GDP
`SL.TLF.ADVN.ZS`                | Labor force with advanced education (% total working-age population with advanced education)
`SL.TLF.ADVN.FE.ZS`             | Labor force with advanced education, female (% female working-age population with advanced education)
`SL.TLF.ADVN.MA.ZS`             | Labor force with advanced education, male (% male working-age population with advanced education)
`SP.POP.TOTL`                   | Population, total
`SP.POP.TOTL.FE.IN`             | Population, female
`SP.POP.TOTL.MA.IN`             | Population, male
`SP.PRM.TOTL.IN`                | School age population, primary education, both sexes
`SP.PRM.TOTL.FE.IN`             | School age population, primary education, female
`SP.PRM.TOTL.MA.IN`             | School age population, primary education, male
`SP.SEC.TOTL.IN`                | School age population, secondary education, both sexes
`SP.SEC.TOTL.FE.IN`             | School age population, secondary education, female
`SP.SEC.TOTL.MA.IN`             | School age population, secondary education, male
`UIS.PTRHC.56`                  | Pupil-teacher ratio in tertiary education (headcount basis)
`UIS.SAP.CE`                    | Population of compulsory school age, both sexes
`UIS.SAP.CE.F`                  | Population of compulsory school age, female
`UIS.SAP.CE.M`                  | Population of compulsory school age, male
`UIS.XGDP.1.FSGOV`              | Government expenditure on primary education as % GDP
`UIS.XGDP.23.FSGOV`             | Government expenditure on secondary education as % GDP
`UIS.XGDP.56.FSGOV`             | Government expenditure on tertiary education as % GDP
`UIS.X.PPP.1.FSGOV`             | Government expenditure on primary education, millions PPP USD
`UIS.X.PPP.2T3.FSGOV`           | Government expenditure on secondary education, millions PPP USD
`UIS.X.PPP.5T8.FSGOV`           | Government expenditure on tertiary education, millions PPP USD
`UIS.XUNIT.GDPCAP.1.FSGOV`      | Initial government funding per primary student as % GDP per capita
`UIS.XUNIT.GDPCAP.23.FSGOV`     | Initial government funding per secondary student as % GDP per capita
`UIS.XUNIT.GDPCAP.5T8.FSGOV`    | Initial government funding per tertiary student as % GDP per capita
`UIS.XUNIT.PPP.1.FSGOV.FFNTR`   | Initial government funding per primary student, PPP USD
`UIS.XUNIT.PPP.2T3.FSGOV.FFNTR` | Initial government funding per secondary student, PPP USD
`UIS.XUNIT.PPP.5T8.FSGOV.FFNTR` | Initial government funding per tertiary student, PPP USD
`UIS.XUNIT.US.1.FSGOV.FFNTR`    | Initial government funding per primary student, USD
`UIS.XUNIT.US.23.FSGOV.FFNTR`   | Initial government funding per secondary student, USD
`UIS.XUNIT.US.5T8.FSGOV.FFNTR`  | Initial government funding per tertiary student, USD
`UIS.X.US.1.FSGOV`              | Government expenditure on primary education, millions USD
`UIS.X.US.2T3.FSGOV`            | Government expenditure on secondary education, millions USD
`UIS.X.US.5T8.FSGOV`            | Government expenditure on tertiary education, millions USD






## Food and Nutrient Database for Dietary Studies (FNDDS)


The Food Surveys Research Group affiliated with the
US Department of Agriculture has published the
Food and Nutrient Database for Dietary Studies 2015-2016.
The database list nutrients in 8690 foods and beverages.
See https://www.ars.usda.gov/ARSUserFiles/80400530/pdf/fndds/2015_2016_FNDDS_Doc.pdf
for detailed documentation.





`fndds_nutrients`    |
---------------------|---------------------------------------------
Last updated         | 2016
Provider             | US Department of Agriculture, Agricultural Research Service
License              | Public Domain
Source               | http://www.ars.usda.gov/nea/bhnrc/fsrg




```{r datasets_fndds_nutrients,echo=-1}
set.seed(421)
fndds_nutrients <- read.csv("datasets/fndds_nutrients_2016.csv.gz",
    comment.char="#")
fndds_nutrients[1:6, c(1:7, 10)] # preview
```




All nutrient amounts are given as per 100 g edible portion.

Column                              | Description
------------------------------------|---------------------------------------------
`Code`                              | Unique 8-digit identification code
`Description`                       | Primary description for a food/beverage
`WWEIA_Code`                        | Unique 4-digit identification code
`WWEIA_Description`                 | Description for a WWEIA category
`Energy`                            | Energy (kcal)
`Protein`                           | Protein (g)
`Carbohydrate`                      | Carbohydrate (g)
`Sugars_total`                      | Sugars, total (g)
`Fiber_total_dietary`               | Fiber, total dietary (g)
`Fat_total`                         | Total Fat (g)
`Fatty_acids_total_saturated`       | Fatty acids, total saturated (g)
`Fatty_acids_total_monounsaturated` | Fatty acids, total monounsaturated (g)
`Fatty_acids_total_polyunsaturated` | Fatty acids, total polyunsaturated (g)
`Cholesterol`                       | Cholesterol (mg)
`Retinol`                           | Retinol (mcg)
`Vitamin_A_RAE`                     | Vitamin A, RAE (mcg_RAE)
`Carotene_alpha`                    | Carotene, alpha (mcg)
`Carotene_beta`                     | Carotene, beta (mcg)
`Cryptoxanthin_beta`                | Cryptoxanthin, beta (mcg)
`Lycopene`                          | Lycopene (mcg)
`Lutein_zeaxanthin`                 | Lutein + zeaxanthin (mcg)
`Thiamin`                           | Thiamin (mg)
`Riboflavin`                        | Riboflavin (mg)
`Niacin`                            | Niacin (mg)
`Vitamin_B6`                        | Vitamin B-6 (mg)
`Folic_acid`                        | Folic acid (mcg)
`Folate_food`                       | Folate, food (mcg)
`Folate_DFE`                        | Folate, DFE (mcg_DFE)
`Folate_total`                      | Folate, total (mcg)
`Choline_total`                     | Choline, total (mg)
`Vitamin_B12`                       | Vitamin B-12 (mcg)
`Vitamin_B12_added`                 | Vitamin B-12, added (mcg)
`Vitamin_C`                         | Vitamin C (mg)
`Vitamin_D`                         | Vitamin D (D2 + D3) (mcg)
`Vitamin_E_alphatocopherol`         | Vitamin E (alpha-tocopherol) (mg)
`Vitamin_E_added`                   | Vitamin E, added (mg)
`Vitamin_K_phylloquinone`           | Vitamin K (phylloquinone) (mcg)
`Calcium`                           | Calcium (mg)
`Phosphorus`                        | Phosphorus (mg)
`Magnesium`                         | Magnesium (mg)
`Iron`                              | Iron (mg)
`Zinc`                              | Zinc (mg)
`Copper`                            | Copper (mg)
`Selenium`                          | Selenium (mcg)
`Potassium`                         | Potassium (mg)
`Sodium`                            | Sodium (mg)
`Caffeine`                          | Caffeine (mg)
`Theobromine`                       | Theobromine (mg)
`Alcohol`                           | Alcohol (g)
`Fatty_acid_4_0`                    | 4:0    (g)
`Fatty_acid_6_0`                    | 6:0    (g)
`Fatty_acid_8_0`                    | 8:0    (g)
`Fatty_acid_10_0`                   | 10:0    (g)
`Fatty_acid_12_0`                   | 12:0    (g)
`Fatty_acid_14_0`                   | 14:0    (g)
`Fatty_acid_16_0`                   | 16:0    (g)
`Fatty_acid_18_0`                   | 18:0    (g)
`Fatty_acid_16_1`                   | 16:1        (g)
`Fatty_acid_18_1`                   | 18:1    (g)
`Fatty_acid_20_1`                   | 20:1    (g)
`Fatty_acid_22_1`                   | 22:1    (g)
`Fatty_acid_18_2`                   | 18:2    (g)
`Fatty_acid_18_3`                   | 18:3    (g)
`Fatty_acid_18_4`                   | 18:4    (g)
`Fatty_acid_20_4`                   | 20:4    (g)
`Fatty_acid_20_5_n3`                | 20:5 n-3 (g)
`Fatty_acid_22_5_n3`                | 22:5 n-3 (g)
`Fatty_acid_22_6_n3`                | 22:6 n-3 (g)
`Water`                             | Water (g)



<!--
See also:

https://fdc.nal.usda.gov/download-datasets.html

-->


<!-- Terms of use:

https://www.usda.gov/policies-and-links

USDA food composition data are in the public domain and they are not copyrighted.
No permission is needed for their use.
US Department of Agriculture, Agricultural Research Service.
FoodData Central, 2020. fdc.nal.usda.gov.

Most information presented on the USDA Web site is considered public domain
information. Public domain information may be freely distributed or copied,
but use of appropriate byline/photo/image credits is requested. Attribution
may be cited as follows: "US Department of Agriculture."

-->







## Clustering Benchmarks

In the Exercises section of
Chapter XXX<!-- TODO --> we study a few clustering benchmark datasets.
They are two-dimensional, so that it's possible to visualise
the obtained results and quality of the obtained clusterings.

The `wut_isolation`, `wut_mk2` and `wut_z3` datasets
were created by the author's fantastic students at Warsaw University of Technology
and are part of the *Benchmark Suite for Clustering Algorithms - Version 1* .


`wut_*`              |
---------------------|---------------------------------------------
Last updated         | 23 April 2020
Authors              | Anna Gierlak, Mateusz Kobyłka, Aleksander Truszczyński
License              | Creative Commons Attribution 4.0 International License
Source               | https://github.com/gagolews/clustering_benchmarks_v1


The `sipu_aggregation` [@clustering_aggregation],
`sipu_pathbased` [@pathbased] and
`sipu_unbalance` [@external_cluster_validity]
datasets are available at the SIPU
(Speech and Image Processing Unit, School of Computing, University of Eastern Finland)
website.


`sipu_*`             |
---------------------|---------------------------------------------
Last updated         | 2018
Provider             | Pasi Fränti and Sami Sieranoja [@ClusteringDatasets]
License              | Public Domain
Source               | http://cs.joensuu.fi/sipu/datasets/



## Movie Lens (TODO)


<!-- (permission required)

From:	GroupLens Admin <gladmin@umn.edu>
To:	gladmin GroupLens Administrative Assistant <gladmin@umn.edu>
Subject:	Movielens Dataset usage
Date:	Tue, 26 May 2020 08:46:21 -0500 (2020-05-26 23:46)

Hello!

Thank you for completing the form to request dataset usage.
You have been approved to use the datasets as you have described
in this form. Please notify us of any publications that result
from this usage, and follow the guidelines laid out for usage
in the associated readme file.

Have a great week, and happy researching!

~Laura

------
Assistant to Professors Joe Konstan, Loren Terveen, & Lana Yarosh
University of Minnesota, Department of Computer Science & Engineering
200 Union Street SE, 4-192 Keller Hall
Minneapolis, MN  55455
(612)626-2057
http://grouplens.org/
https://twitter.com/grouplens

-->

movies, ratings


<!-- Terms of use:

TODO:

-->



## Other (TODO)


the famous Fisher's Iris flower dataset,
see `?iris` in R
and https://en.wikipedia.org/wiki/Iris_flower_data_set.

titanic::

The famous `Boston` dataset from the `MASS` package
records the historical (in the 1970s) median house value
(`medv` column, in 1,000s USD) for 506 suburbs around
Boston, MA, USA.

You can access the dataset by calling:

```{r Boston_load1,message=FALSE}
# call install.packages("MASS") first (only once)
library("MASS")
head(Boston, 3)
```

Read the description of each of the 14 columns in the dataset's manual,
see `?Boston`.





Here is a famous illustrative example proposed by
the statistician Francis Anscombe in the early 1970s.

```{r anscombe}
print(anscombe) # `anscombe` is a built-in object
```

What we see above is a single data frame
that encodes four separate datasets:
`anscombe$x1` and `anscombe$y1` define the first pair of variables,
`anscombe$x2` and `anscombe$y2` define the second pair and so forth.




MNIST digits

MNIST fashion


Wisconsin Diagnostic Breast Cancer (WDBC)

```{r dataset_wdbc}
wdbc <- read.csv("datasets/wdbc.csv", comment.char="#")
head(wdbc, 2)
```

<!--

## Fuel Economy


https://fueleconomy.gov/feg/download.shtml

Terms of use:

TODO:


https://data.europa.eu/euodp/en/data/

https://openpsychometrics.org/_rawdata/

-->

