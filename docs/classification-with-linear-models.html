<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Classification with Linear Models | Lightweight Machine Learning Classics with R</title>
  <meta name="description" content="Explore some of the most fundamental algorithms which have stood the test of time and provide the basis for innovative solutions in data-driven AI. Learn how to use the R language for implementing various stages of data processing and modelling activities. Appreciate mathematics as the universal language for formalising data-intense problems and communicating their solutions. The book is for you if you’re yet to be fluent with university-level linear algebra, calculus and probability theory or you’ve forgotten all the maths you’ve ever learned, and are seeking a gentle, yet thorough, introduction to the topic." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Classification with Linear Models | Lightweight Machine Learning Classics with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://lmlcr.gagolewski.com" />
  
  <meta property="og:description" content="Explore some of the most fundamental algorithms which have stood the test of time and provide the basis for innovative solutions in data-driven AI. Learn how to use the R language for implementing various stages of data processing and modelling activities. Appreciate mathematics as the universal language for formalising data-intense problems and communicating their solutions. The book is for you if you’re yet to be fluent with university-level linear algebra, calculus and probability theory or you’ve forgotten all the maths you’ve ever learned, and are seeking a gentle, yet thorough, introduction to the topic." />
  <meta name="github-repo" content="gagolews/lmlcr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Classification with Linear Models | Lightweight Machine Learning Classics with R" />
  
  <meta name="twitter:description" content="Explore some of the most fundamental algorithms which have stood the test of time and provide the basis for innovative solutions in data-driven AI. Learn how to use the R language for implementing various stages of data processing and modelling activities. Appreciate mathematics as the universal language for formalising data-intense problems and communicating their solutions. The book is for you if you’re yet to be fluent with university-level linear algebra, calculus and probability theory or you’ve forgotten all the maths you’ve ever learned, and are seeking a gentle, yet thorough, introduction to the topic." />
  

<meta name="author" content="Marek Gagolewski" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-regression.html"/>
<link rel="next" href="continuous-optimisation-with-iterative-algorithms.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<style type="text/css">
div.exercise {
    font-style: italic;
    border-left: 2px solid gray;
    padding-left: 1em;
}

details.solution {
    border-left: 2px solid #ff8888;
    padding-left: 1em;
    margin-bottom: 2em;
}

</style>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li style='font-style: italic' ><a href="./">LMLCR</a></li>
<li style='font-size: smaller' ><a href="https://www.gagolewski.com">Marek Gagolewski</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-machine-learning"><i class="fa fa-check"></i><b>1.1</b> What is Machine Learning?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#main-types-of-machine-learning-problems"><i class="fa fa-check"></i><b>1.1.1</b> Main Types of Machine Learning Problems</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#supervised-learning"><i class="fa fa-check"></i><b>1.2</b> Supervised Learning</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#formalism"><i class="fa fa-check"></i><b>1.2.1</b> Formalism</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#desired-outputs"><i class="fa fa-check"></i><b>1.2.2</b> Desired Outputs</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#types-of-supervised-learning-problems"><i class="fa fa-check"></i><b>1.2.3</b> Types of Supervised Learning Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html"><i class="fa fa-check"></i><b>2</b> Classification with K-Nearest Neighbours</a><ul>
<li class="chapter" data-level="2.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a><ul>
<li class="chapter" data-level="2.1.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#classification-task"><i class="fa fa-check"></i><b>2.1.1</b> Classification Task</a></li>
<li class="chapter" data-level="2.1.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#data"><i class="fa fa-check"></i><b>2.1.2</b> Data</a></li>
<li class="chapter" data-level="2.1.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#training-and-test-sets"><i class="fa fa-check"></i><b>2.1.3</b> Training and Test Sets</a></li>
<li class="chapter" data-level="2.1.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#discussed-methods"><i class="fa fa-check"></i><b>2.1.4</b> Discussed Methods</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#k-nearest-neighbour-classifier"><i class="fa fa-check"></i><b>2.2</b> K-nearest Neighbour Classifier</a><ul>
<li class="chapter" data-level="2.2.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#introduction-2"><i class="fa fa-check"></i><b>2.2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#example-in-r"><i class="fa fa-check"></i><b>2.2.2</b> Example in R</a></li>
<li class="chapter" data-level="2.2.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#feature-engineering"><i class="fa fa-check"></i><b>2.2.3</b> Feature Engineering</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#model-assessment-and-selection"><i class="fa fa-check"></i><b>2.3</b> Model Assessment and Selection</a><ul>
<li class="chapter" data-level="2.3.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#performance-metrics"><i class="fa fa-check"></i><b>2.3.1</b> Performance Metrics</a></li>
<li class="chapter" data-level="2.3.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#how-to-choose-k-for-k-nn-classification"><i class="fa fa-check"></i><b>2.3.2</b> How to Choose K for K-NN Classification?</a></li>
<li class="chapter" data-level="2.3.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#training-validation-and-test-sets"><i class="fa fa-check"></i><b>2.3.3</b> Training, Validation and Test sets</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#implementing-a-k-nn-classifier"><i class="fa fa-check"></i><b>2.4</b> Implementing a K-NN Classifier (*)</a><ul>
<li class="chapter" data-level="2.4.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#factor-data-type"><i class="fa fa-check"></i><b>2.4.1</b> Factor Data Type</a></li>
<li class="chapter" data-level="2.4.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#main-routine"><i class="fa fa-check"></i><b>2.4.2</b> Main Routine (*)</a></li>
<li class="chapter" data-level="2.4.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#mode"><i class="fa fa-check"></i><b>2.4.3</b> Mode</a></li>
<li class="chapter" data-level="2.4.4" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#nn-search-routines"><i class="fa fa-check"></i><b>2.4.4</b> NN Search Routines (*)</a></li>
<li class="chapter" data-level="2.4.5" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#different-metrics"><i class="fa fa-check"></i><b>2.4.5</b> Different Metrics (*)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#exercises"><i class="fa fa-check"></i><b>2.5</b> Exercises</a><ul>
<li class="chapter" data-level="2.5.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#wine-quality-best-k-nn-parameters-via-cross-validation"><i class="fa fa-check"></i><b>2.5.1</b> Wine Quality – Best K-NN Parameters via Cross-Validation (*)</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#outro"><i class="fa fa-check"></i><b>2.6</b> Outro</a><ul>
<li class="chapter" data-level="2.6.1" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#remarks"><i class="fa fa-check"></i><b>2.6.1</b> Remarks</a></li>
<li class="chapter" data-level="2.6.2" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#side-note-k-nn-regression"><i class="fa fa-check"></i><b>2.6.2</b> Side Note: K-NN Regression</a></li>
<li class="chapter" data-level="2.6.3" data-path="classification-with-k-nearest-neighbours.html"><a href="classification-with-k-nearest-neighbours.html#further-reading"><i class="fa fa-check"></i><b>2.6.3</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html"><i class="fa fa-check"></i><b>3</b> Decision and Regression Trees</a><ul>
<li class="chapter" data-level="3.1" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#introduction-3"><i class="fa fa-check"></i><b>3.1</b> Introduction</a><ul>
<li class="chapter" data-level="3.1.1" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#classification-task-1"><i class="fa fa-check"></i><b>3.1.1</b> Classification Task</a></li>
<li class="chapter" data-level="3.1.2" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#data-1"><i class="fa fa-check"></i><b>3.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#decision-trees"><i class="fa fa-check"></i><b>3.2</b> Decision Trees</a><ul>
<li class="chapter" data-level="3.2.1" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#introduction-4"><i class="fa fa-check"></i><b>3.2.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2.2" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#example-in-r-1"><i class="fa fa-check"></i><b>3.2.2</b> Example in R</a></li>
<li class="chapter" data-level="3.2.3" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#a-note-on-decision-tree-learning"><i class="fa fa-check"></i><b>3.2.3</b> A Note on Decision Tree Learning</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#exercises-1"><i class="fa fa-check"></i><b>3.3</b> Exercises</a><ul>
<li class="chapter" data-level="3.3.1" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#edstats-where-girls-are-better-at-maths-than-boys"><i class="fa fa-check"></i><b>3.3.1</b> EdStats – Where Girls Are Better at Maths Than Boys?</a></li>
<li class="chapter" data-level="3.3.2" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#edstats-and-world-factbook-joining-forces"><i class="fa fa-check"></i><b>3.3.2</b> EdStats and World Factbook – Joining Forces</a></li>
<li class="chapter" data-level="3.3.3" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#wine-quality-random-forest-and-xgboost"><i class="fa fa-check"></i><b>3.3.3</b> Wine Quality – Random Forest and XGBoost (*)</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#outro-1"><i class="fa fa-check"></i><b>3.4</b> Outro</a><ul>
<li class="chapter" data-level="3.4.1" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#remarks-1"><i class="fa fa-check"></i><b>3.4.1</b> Remarks</a></li>
<li class="chapter" data-level="3.4.2" data-path="decision-and-regression-trees.html"><a href="decision-and-regression-trees.html#further-reading-1"><i class="fa fa-check"></i><b>3.4.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-regression"><i class="fa fa-check"></i><b>4.1</b> Simple Regression</a><ul>
<li class="chapter" data-level="4.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#introduction-5"><i class="fa fa-check"></i><b>4.1.1</b> Introduction</a></li>
<li class="chapter" data-level="4.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#search-space-and-objective"><i class="fa fa-check"></i><b>4.1.2</b> Search Space and Objective</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>4.2</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="4.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#introduction-6"><i class="fa fa-check"></i><b>4.2.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#solution-in-r"><i class="fa fa-check"></i><b>4.2.2</b> Solution in R</a></li>
<li class="chapter" data-level="4.2.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#analytic-solution"><i class="fa fa-check"></i><b>4.2.3</b> Analytic Solution</a></li>
<li class="chapter" data-level="4.2.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#derivation-of-the-solution"><i class="fa fa-check"></i><b>4.2.4</b> Derivation of the Solution (**)</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a><ul>
<li class="chapter" data-level="4.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-anscombe-quartet"><i class="fa fa-check"></i><b>4.3.1</b> The Anscombe Quartet</a></li>
<li class="chapter" data-level="4.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#median-house-value-in-boston"><i class="fa fa-check"></i><b>4.3.2</b> Median House Value in Boston</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#outro-2"><i class="fa fa-check"></i><b>4.4</b> Outro</a><ul>
<li class="chapter" data-level="4.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#remarks-2"><i class="fa fa-check"></i><b>4.4.1</b> Remarks</a></li>
<li class="chapter" data-level="4.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#further-reading-2"><i class="fa fa-check"></i><b>4.4.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>5</b> Multiple Regression</a><ul>
<li class="chapter" data-level="5.1" data-path="multiple-regression.html"><a href="multiple-regression.html#introduction-7"><i class="fa fa-check"></i><b>5.1</b> Introduction</a><ul>
<li class="chapter" data-level="5.1.1" data-path="multiple-regression.html"><a href="multiple-regression.html#formalism-1"><i class="fa fa-check"></i><b>5.1.1</b> Formalism</a></li>
<li class="chapter" data-level="5.1.2" data-path="multiple-regression.html"><a href="multiple-regression.html#simple-linear-regression---recap"><i class="fa fa-check"></i><b>5.1.2</b> Simple Linear Regression - Recap</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="multiple-regression.html"><a href="multiple-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>5.2</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="5.2.1" data-path="multiple-regression.html"><a href="multiple-regression.html#problem-formulation"><i class="fa fa-check"></i><b>5.2.1</b> Problem Formulation</a></li>
<li class="chapter" data-level="5.2.2" data-path="multiple-regression.html"><a href="multiple-regression.html#fitting-a-linear-model-in-r"><i class="fa fa-check"></i><b>5.2.2</b> Fitting a Linear Model in R</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="multiple-regression.html"><a href="multiple-regression.html#finding-the-best-model"><i class="fa fa-check"></i><b>5.3</b> Finding the Best Model</a><ul>
<li class="chapter" data-level="5.3.1" data-path="multiple-regression.html"><a href="multiple-regression.html#model-diagnostics"><i class="fa fa-check"></i><b>5.3.1</b> Model Diagnostics</a></li>
<li class="chapter" data-level="5.3.2" data-path="multiple-regression.html"><a href="multiple-regression.html#variable-selection"><i class="fa fa-check"></i><b>5.3.2</b> Variable Selection</a></li>
<li class="chapter" data-level="5.3.3" data-path="multiple-regression.html"><a href="multiple-regression.html#variable-transformation"><i class="fa fa-check"></i><b>5.3.3</b> Variable Transformation</a></li>
<li class="chapter" data-level="5.3.4" data-path="multiple-regression.html"><a href="multiple-regression.html#predictive-vs.-descriptive-power"><i class="fa fa-check"></i><b>5.3.4</b> Predictive vs. Descriptive Power</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="multiple-regression.html"><a href="multiple-regression.html#exercises-3"><i class="fa fa-check"></i><b>5.4</b> Exercises</a><ul>
<li class="chapter" data-level="5.4.1" data-path="multiple-regression.html"><a href="multiple-regression.html#anscombes-quartet-revisited"><i class="fa fa-check"></i><b>5.4.1</b> Anscombe’s Quartet Revisited</a></li>
<li class="chapter" data-level="5.4.2" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-simple-models-involving-the-gdp-per-capita"><i class="fa fa-check"></i><b>5.4.2</b> Countries of the World – Simple models involving the GDP per capita</a></li>
<li class="chapter" data-level="5.4.3" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-most-correlated-variables"><i class="fa fa-check"></i><b>5.4.3</b> Countries of the World – Most correlated variables (*)</a></li>
<li class="chapter" data-level="5.4.4" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-a-non-linear-model-based-on-the-gdp-per-capita"><i class="fa fa-check"></i><b>5.4.4</b> Countries of the World – A non-linear model based on the GDP per capita</a></li>
<li class="chapter" data-level="5.4.5" data-path="multiple-regression.html"><a href="multiple-regression.html#countries-of-the-world-a-multiple-regression-model-for-the-per-capita-gdp"><i class="fa fa-check"></i><b>5.4.5</b> Countries of the World – A multiple regression model for the per capita GDP</a></li>
<li class="chapter" data-level="5.4.6" data-path="multiple-regression.html"><a href="multiple-regression.html#median-house-value-in-boston-continued"><i class="fa fa-check"></i><b>5.4.6</b> Median House Value in Boston (Continued)</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="multiple-regression.html"><a href="multiple-regression.html#outro-3"><i class="fa fa-check"></i><b>5.5</b> Outro</a><ul>
<li class="chapter" data-level="5.5.1" data-path="multiple-regression.html"><a href="multiple-regression.html#remarks-3"><i class="fa fa-check"></i><b>5.5.1</b> Remarks</a></li>
<li class="chapter" data-level="5.5.2" data-path="multiple-regression.html"><a href="multiple-regression.html#other-methods-for-regression"><i class="fa fa-check"></i><b>5.5.2</b> Other Methods for Regression</a></li>
<li class="chapter" data-level="5.5.3" data-path="multiple-regression.html"><a href="multiple-regression.html#derivation-of-the-solution-1"><i class="fa fa-check"></i><b>5.5.3</b> Derivation of the Solution (**)</a></li>
<li class="chapter" data-level="5.5.4" data-path="multiple-regression.html"><a href="multiple-regression.html#solution-in-matrix-form"><i class="fa fa-check"></i><b>5.5.4</b> Solution in Matrix Form (***)</a></li>
<li class="chapter" data-level="5.5.5" data-path="multiple-regression.html"><a href="multiple-regression.html#pearsons-r-in-matrix-form"><i class="fa fa-check"></i><b>5.5.5</b> Pearson’s r in Matrix Form (**)</a></li>
<li class="chapter" data-level="5.5.6" data-path="multiple-regression.html"><a href="multiple-regression.html#further-reading-3"><i class="fa fa-check"></i><b>5.5.6</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html"><i class="fa fa-check"></i><b>6</b> Classification with Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#introduction-8"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#classification-task-2"><i class="fa fa-check"></i><b>6.1.1</b> Classification Task</a></li>
<li class="chapter" data-level="6.1.2" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#data-2"><i class="fa fa-check"></i><b>6.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#binary-logistic-regression"><i class="fa fa-check"></i><b>6.2</b> Binary Logistic Regression</a><ul>
<li class="chapter" data-level="6.2.1" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#motivation"><i class="fa fa-check"></i><b>6.2.1</b> Motivation</a></li>
<li class="chapter" data-level="6.2.2" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#logistic-model"><i class="fa fa-check"></i><b>6.2.2</b> Logistic Model</a></li>
<li class="chapter" data-level="6.2.3" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#example-in-r-2"><i class="fa fa-check"></i><b>6.2.3</b> Example in R</a></li>
<li class="chapter" data-level="6.2.4" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#loss-function-cross-entropy"><i class="fa fa-check"></i><b>6.2.4</b> Loss Function: Cross-entropy</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#exercises-4"><i class="fa fa-check"></i><b>6.3</b> Exercises</a><ul>
<li class="chapter" data-level="6.3.1" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#edstats-fitting-of-binary-logistic-regression-models"><i class="fa fa-check"></i><b>6.3.1</b> EdStats – Fitting of Binary Logistic Regression Models</a></li>
<li class="chapter" data-level="6.3.2" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#edstats-variable-selection-in-binary-logistic-regression"><i class="fa fa-check"></i><b>6.3.2</b> EdStats – Variable Selection in Binary Logistic Regression (*)</a></li>
<li class="chapter" data-level="6.3.3" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#currency-exchange-rates-growthfall"><i class="fa fa-check"></i><b>6.3.3</b> Currency Exchange Rates Growth/Fall</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#outro-4"><i class="fa fa-check"></i><b>6.4</b> Outro</a><ul>
<li class="chapter" data-level="6.4.1" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#remarks-4"><i class="fa fa-check"></i><b>6.4.1</b> Remarks</a></li>
<li class="chapter" data-level="6.4.2" data-path="classification-with-linear-models.html"><a href="classification-with-linear-models.html#further-reading-4"><i class="fa fa-check"></i><b>6.4.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html"><i class="fa fa-check"></i><b>7</b> Continuous Optimisation with Iterative Algorithms</a><ul>
<li class="chapter" data-level="7.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#introduction-9"><i class="fa fa-check"></i><b>7.1</b> Introduction</a><ul>
<li class="chapter" data-level="7.1.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#optimisation-problems"><i class="fa fa-check"></i><b>7.1.1</b> Optimisation Problems</a></li>
<li class="chapter" data-level="7.1.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#types-of-minima-and-maxima"><i class="fa fa-check"></i><b>7.1.2</b> Types of Minima and Maxima</a></li>
<li class="chapter" data-level="7.1.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-objective-over-a-2d-domain"><i class="fa fa-check"></i><b>7.1.3</b> Example Objective over a 2D Domain</a></li>
<li class="chapter" data-level="7.1.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-optimisation-problems-in-machine-learning"><i class="fa fa-check"></i><b>7.1.4</b> Example Optimisation Problems in Machine Learning</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#iterative-methods"><i class="fa fa-check"></i><b>7.2</b> Iterative Methods</a><ul>
<li class="chapter" data-level="7.2.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#introduction-10"><i class="fa fa-check"></i><b>7.2.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-in-r-3"><i class="fa fa-check"></i><b>7.2.2</b> Example in R</a></li>
<li class="chapter" data-level="7.2.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#convergence-to-local-optima"><i class="fa fa-check"></i><b>7.2.3</b> Convergence to Local Optima</a></li>
<li class="chapter" data-level="7.2.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#random-restarts"><i class="fa fa-check"></i><b>7.2.4</b> Random Restarts</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#gradient-descent"><i class="fa fa-check"></i><b>7.3</b> Gradient Descent</a><ul>
<li class="chapter" data-level="7.3.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#function-gradient"><i class="fa fa-check"></i><b>7.3.1</b> Function Gradient (*)</a></li>
<li class="chapter" data-level="7.3.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#three-facts-on-the-gradient"><i class="fa fa-check"></i><b>7.3.2</b> Three Facts on the Gradient</a></li>
<li class="chapter" data-level="7.3.3" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#gradient-descent-algorithm-gd"><i class="fa fa-check"></i><b>7.3.3</b> Gradient Descent Algorithm (GD)</a></li>
<li class="chapter" data-level="7.3.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#example-mnist"><i class="fa fa-check"></i><b>7.3.4</b> Example: MNIST (*)</a></li>
<li class="chapter" data-level="7.3.5" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#stochastic-gradient-descent-sgd"><i class="fa fa-check"></i><b>7.3.5</b> Stochastic Gradient Descent (SGD) (*)</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#a-note-on-convex-optimisation"><i class="fa fa-check"></i><b>7.4</b> A Note on Convex Optimisation (*)</a></li>
<li class="chapter" data-level="7.5" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#outro-5"><i class="fa fa-check"></i><b>7.5</b> Outro</a><ul>
<li class="chapter" data-level="7.5.1" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#remarks-5"><i class="fa fa-check"></i><b>7.5.1</b> Remarks</a></li>
<li class="chapter" data-level="7.5.2" data-path="continuous-optimisation-with-iterative-algorithms.html"><a href="continuous-optimisation-with-iterative-algorithms.html#further-reading-5"><i class="fa fa-check"></i><b>7.5.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html"><i class="fa fa-check"></i><b>8</b> Discrete Optimisation</a><ul>
<li class="chapter" data-level="8.1" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#introduction-11"><i class="fa fa-check"></i><b>8.1</b> Introduction</a><ul>
<li class="chapter" data-level="8.1.1" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#recap"><i class="fa fa-check"></i><b>8.1.1</b> Recap</a></li>
<li class="chapter" data-level="8.1.2" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#k-means-revisited"><i class="fa fa-check"></i><b>8.1.2</b> K-means Revisited</a></li>
<li class="chapter" data-level="8.1.3" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#optim-vs.-kmeans"><i class="fa fa-check"></i><b>8.1.3</b> optim() vs. kmeans()</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#outro-6"><i class="fa fa-check"></i><b>8.2</b> Outro</a><ul>
<li class="chapter" data-level="8.2.1" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#remarks-6"><i class="fa fa-check"></i><b>8.2.1</b> Remarks</a></li>
<li class="chapter" data-level="8.2.2" data-path="discrete-optimisation.html"><a href="discrete-optimisation.html#further-reading-6"><i class="fa fa-check"></i><b>8.2.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>9</b> Clustering</a><ul>
<li class="chapter" data-level="9.1" data-path="clustering.html"><a href="clustering.html#unsupervised-learning"><i class="fa fa-check"></i><b>9.1</b> Unsupervised Learning</a><ul>
<li class="chapter" data-level="9.1.1" data-path="clustering.html"><a href="clustering.html#introduction-12"><i class="fa fa-check"></i><b>9.1.1</b> Introduction</a></li>
<li class="chapter" data-level="9.1.2" data-path="clustering.html"><a href="clustering.html#main-types-of-unsupervised-learning-problems"><i class="fa fa-check"></i><b>9.1.2</b> Main Types of Unsupervised Learning Problems</a></li>
<li class="chapter" data-level="9.1.3" data-path="clustering.html"><a href="clustering.html#definitions"><i class="fa fa-check"></i><b>9.1.3</b> Definitions</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="clustering.html"><a href="clustering.html#k-means-clustering"><i class="fa fa-check"></i><b>9.2</b> K-means Clustering</a><ul>
<li class="chapter" data-level="9.2.1" data-path="clustering.html"><a href="clustering.html#example-in-r-4"><i class="fa fa-check"></i><b>9.2.1</b> Example in R</a></li>
<li class="chapter" data-level="9.2.2" data-path="clustering.html"><a href="clustering.html#problem-statement"><i class="fa fa-check"></i><b>9.2.2</b> Problem Statement</a></li>
<li class="chapter" data-level="9.2.3" data-path="clustering.html"><a href="clustering.html#algorithms-for-the-k-means-problem"><i class="fa fa-check"></i><b>9.2.3</b> Algorithms for the K-means Problem</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="clustering.html"><a href="clustering.html#agglomerative-hierarchical-clustering"><i class="fa fa-check"></i><b>9.3</b> Agglomerative Hierarchical Clustering</a><ul>
<li class="chapter" data-level="9.3.1" data-path="clustering.html"><a href="clustering.html#introduction-13"><i class="fa fa-check"></i><b>9.3.1</b> Introduction</a></li>
<li class="chapter" data-level="9.3.2" data-path="clustering.html"><a href="clustering.html#example-in-r-5"><i class="fa fa-check"></i><b>9.3.2</b> Example in R</a></li>
<li class="chapter" data-level="9.3.3" data-path="clustering.html"><a href="clustering.html#linkage-functions"><i class="fa fa-check"></i><b>9.3.3</b> Linkage Functions</a></li>
<li class="chapter" data-level="9.3.4" data-path="clustering.html"><a href="clustering.html#cluster-dendrograms"><i class="fa fa-check"></i><b>9.3.4</b> Cluster Dendrograms</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="clustering.html"><a href="clustering.html#exercises-5"><i class="fa fa-check"></i><b>9.4</b> Exercises</a><ul>
<li class="chapter" data-level="9.4.1" data-path="clustering.html"><a href="clustering.html#clustering-of-the-world-factbook"><i class="fa fa-check"></i><b>9.4.1</b> Clustering of the World Factbook</a></li>
<li class="chapter" data-level="9.4.2" data-path="clustering.html"><a href="clustering.html#unbalance-dataset-k-means-needs-multiple-starts"><i class="fa fa-check"></i><b>9.4.2</b> Unbalance Dataset – K-Means Needs Multiple Starts</a></li>
<li class="chapter" data-level="9.4.3" data-path="clustering.html"><a href="clustering.html#clustering-of-typical-2d-benchmark-datasets"><i class="fa fa-check"></i><b>9.4.3</b> Clustering of Typical 2D Benchmark Datasets</a></li>
<li class="chapter" data-level="9.4.4" data-path="clustering.html"><a href="clustering.html#wine-quality-volatile.acidity-and-sulphates"><i class="fa fa-check"></i><b>9.4.4</b> Wine Quality – <code>volatile.acidity</code> and <code>sulphates</code></a></li>
<li class="chapter" data-level="9.4.5" data-path="clustering.html"><a href="clustering.html#wine-quality-chlorides-and-total.sulfur.dioxide"><i class="fa fa-check"></i><b>9.4.5</b> Wine Quality – <code>chlorides</code> and <code>total.sulfur.dioxide</code></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="clustering.html"><a href="clustering.html#outro-7"><i class="fa fa-check"></i><b>9.5</b> Outro</a><ul>
<li class="chapter" data-level="9.5.1" data-path="clustering.html"><a href="clustering.html#remarks-7"><i class="fa fa-check"></i><b>9.5.1</b> Remarks</a></li>
<li class="chapter" data-level="9.5.2" data-path="clustering.html"><a href="clustering.html#further-reading-7"><i class="fa fa-check"></i><b>9.5.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html"><i class="fa fa-check"></i><b>10</b> Shallow and Deep Neural Networks</a><ul>
<li class="chapter" data-level="10.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-14"><i class="fa fa-check"></i><b>10.1</b> Introduction</a><ul>
<li class="chapter" data-level="10.1.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#binary-logistic-regression-recap"><i class="fa fa-check"></i><b>10.1.1</b> Binary Logistic Regression: Recap</a></li>
<li class="chapter" data-level="10.1.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#data-3"><i class="fa fa-check"></i><b>10.1.2</b> Data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#multinomial-logistic-regression"><i class="fa fa-check"></i><b>10.2</b> Multinomial Logistic Regression</a><ul>
<li class="chapter" data-level="10.2.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#a-note-on-data-representation"><i class="fa fa-check"></i><b>10.2.1</b> A Note on Data Representation</a></li>
<li class="chapter" data-level="10.2.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#extending-logistic-regression"><i class="fa fa-check"></i><b>10.2.2</b> Extending Logistic Regression</a></li>
<li class="chapter" data-level="10.2.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#softmax-function"><i class="fa fa-check"></i><b>10.2.3</b> Softmax Function</a></li>
<li class="chapter" data-level="10.2.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#one-hot-encoding-and-decoding"><i class="fa fa-check"></i><b>10.2.4</b> One-Hot Encoding and Decoding</a></li>
<li class="chapter" data-level="10.2.5" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#cross-entropy-revisited"><i class="fa fa-check"></i><b>10.2.5</b> Cross-entropy Revisited</a></li>
<li class="chapter" data-level="10.2.6" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#problem-formulation-in-matrix-form"><i class="fa fa-check"></i><b>10.2.6</b> Problem Formulation in Matrix Form (**)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#artificial-neural-networks"><i class="fa fa-check"></i><b>10.3</b> Artificial Neural Networks</a><ul>
<li class="chapter" data-level="10.3.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#artificial-neuron"><i class="fa fa-check"></i><b>10.3.1</b> Artificial Neuron</a></li>
<li class="chapter" data-level="10.3.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#logistic-regression-as-a-neural-network"><i class="fa fa-check"></i><b>10.3.2</b> Logistic Regression as a Neural Network</a></li>
<li class="chapter" data-level="10.3.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r-6"><i class="fa fa-check"></i><b>10.3.3</b> Example in R</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#deep-neural-networks"><i class="fa fa-check"></i><b>10.4</b> Deep Neural Networks</a><ul>
<li class="chapter" data-level="10.4.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-15"><i class="fa fa-check"></i><b>10.4.1</b> Introduction</a></li>
<li class="chapter" data-level="10.4.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#activation-functions"><i class="fa fa-check"></i><b>10.4.2</b> Activation Functions</a></li>
<li class="chapter" data-level="10.4.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r---2-layers"><i class="fa fa-check"></i><b>10.4.3</b> Example in R - 2 Layers</a></li>
<li class="chapter" data-level="10.4.4" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#example-in-r---6-layers"><i class="fa fa-check"></i><b>10.4.4</b> Example in R - 6 Layers</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#preprocessing-of-data"><i class="fa fa-check"></i><b>10.5</b> Preprocessing of Data</a><ul>
<li class="chapter" data-level="10.5.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#introduction-16"><i class="fa fa-check"></i><b>10.5.1</b> Introduction</a></li>
<li class="chapter" data-level="10.5.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#image-deskewing"><i class="fa fa-check"></i><b>10.5.2</b> Image Deskewing</a></li>
<li class="chapter" data-level="10.5.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#summary-of-all-the-models-considered"><i class="fa fa-check"></i><b>10.5.3</b> Summary of All the Models Considered</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#outro-8"><i class="fa fa-check"></i><b>10.6</b> Outro</a><ul>
<li class="chapter" data-level="10.6.1" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#remarks-8"><i class="fa fa-check"></i><b>10.6.1</b> Remarks</a></li>
<li class="chapter" data-level="10.6.2" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#beyond-mnist"><i class="fa fa-check"></i><b>10.6.2</b> Beyond MNIST</a></li>
<li class="chapter" data-level="10.6.3" data-path="shallow-and-deep-neural-networks.html"><a href="shallow-and-deep-neural-networks.html#further-reading-8"><i class="fa fa-check"></i><b>10.6.3</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="recommender-systems.html"><a href="recommender-systems.html"><i class="fa fa-check"></i><b>11</b> Recommender Systems</a><ul>
<li class="chapter" data-level="11.1" data-path="recommender-systems.html"><a href="recommender-systems.html#introduction-17"><i class="fa fa-check"></i><b>11.1</b> Introduction</a><ul>
<li class="chapter" data-level="11.1.1" data-path="recommender-systems.html"><a href="recommender-systems.html#the-netflix-prize"><i class="fa fa-check"></i><b>11.1.1</b> The Netflix Prize</a></li>
<li class="chapter" data-level="11.1.2" data-path="recommender-systems.html"><a href="recommender-systems.html#main-approaches"><i class="fa fa-check"></i><b>11.1.2</b> Main Approaches</a></li>
<li class="chapter" data-level="11.1.3" data-path="recommender-systems.html"><a href="recommender-systems.html#formalism-2"><i class="fa fa-check"></i><b>11.1.3</b> Formalism</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="recommender-systems.html"><a href="recommender-systems.html#collaborative-filtering"><i class="fa fa-check"></i><b>11.2</b> Collaborative Filtering</a><ul>
<li class="chapter" data-level="11.2.1" data-path="recommender-systems.html"><a href="recommender-systems.html#example"><i class="fa fa-check"></i><b>11.2.1</b> Example</a></li>
<li class="chapter" data-level="11.2.2" data-path="recommender-systems.html"><a href="recommender-systems.html#similarity-measures"><i class="fa fa-check"></i><b>11.2.2</b> Similarity Measures</a></li>
<li class="chapter" data-level="11.2.3" data-path="recommender-systems.html"><a href="recommender-systems.html#user-based-collaborative-filtering"><i class="fa fa-check"></i><b>11.2.3</b> User-Based Collaborative Filtering</a></li>
<li class="chapter" data-level="11.2.4" data-path="recommender-systems.html"><a href="recommender-systems.html#item-based-collaborative-filtering"><i class="fa fa-check"></i><b>11.2.4</b> Item-Based Collaborative Filtering</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="recommender-systems.html"><a href="recommender-systems.html#exercise-the-movielens-dataset"><i class="fa fa-check"></i><b>11.3</b> Exercise: The MovieLens Dataset (*)</a><ul>
<li class="chapter" data-level="11.3.1" data-path="recommender-systems.html"><a href="recommender-systems.html#dataset"><i class="fa fa-check"></i><b>11.3.1</b> Dataset</a></li>
<li class="chapter" data-level="11.3.2" data-path="recommender-systems.html"><a href="recommender-systems.html#data-cleansing"><i class="fa fa-check"></i><b>11.3.2</b> Data Cleansing</a></li>
<li class="chapter" data-level="11.3.3" data-path="recommender-systems.html"><a href="recommender-systems.html#item-item-similarities"><i class="fa fa-check"></i><b>11.3.3</b> Item-Item Similarities</a></li>
<li class="chapter" data-level="11.3.4" data-path="recommender-systems.html"><a href="recommender-systems.html#example-recommendations"><i class="fa fa-check"></i><b>11.3.4</b> Example Recommendations</a></li>
<li class="chapter" data-level="11.3.5" data-path="recommender-systems.html"><a href="recommender-systems.html#clustering-1"><i class="fa fa-check"></i><b>11.3.5</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="recommender-systems.html"><a href="recommender-systems.html#outro-9"><i class="fa fa-check"></i><b>11.4</b> Outro</a><ul>
<li class="chapter" data-level="11.4.1" data-path="recommender-systems.html"><a href="recommender-systems.html#remarks-9"><i class="fa fa-check"></i><b>11.4.1</b> Remarks</a></li>
<li class="chapter" data-level="11.4.2" data-path="recommender-systems.html"><a href="recommender-systems.html#further-reading-9"><i class="fa fa-check"></i><b>11.4.2</b> Further Reading</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="natural-language-processing.html"><a href="natural-language-processing.html"><i class="fa fa-check"></i><b>12</b> Natural Language Processing</a><ul>
<li class="chapter" data-level="12.1" data-path="natural-language-processing.html"><a href="natural-language-processing.html#to-do"><i class="fa fa-check"></i><b>12.1</b> TO DO</a></li>
<li class="chapter" data-level="12.2" data-path="natural-language-processing.html"><a href="natural-language-processing.html#further-reading-10"><i class="fa fa-check"></i><b>12.2</b> Further Reading</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="notation-convention.html"><a href="notation-convention.html"><i class="fa fa-check"></i><b>A</b> Notation Convention</a></li>
<li class="chapter" data-level="B" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html"><i class="fa fa-check"></i><b>B</b> Setting Up the R Environment</a><ul>
<li class="chapter" data-level="B.1" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-r"><i class="fa fa-check"></i><b>B.1</b> Installing R</a></li>
<li class="chapter" data-level="B.2" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-an-ide"><i class="fa fa-check"></i><b>B.2</b> Installing an IDE</a></li>
<li class="chapter" data-level="B.3" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#installing-recommended-packages"><i class="fa fa-check"></i><b>B.3</b> Installing Recommended Packages</a></li>
<li class="chapter" data-level="B.4" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#first-r-script-in-rstudio"><i class="fa fa-check"></i><b>B.4</b> First R Script in RStudio</a></li>
<li class="chapter" data-level="B.5" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#exercises-6"><i class="fa fa-check"></i><b>B.5</b> Exercises</a><ul>
<li class="chapter" data-level="B.5.1" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#first-steps-with-vectors"><i class="fa fa-check"></i><b>B.5.1</b> First Steps with Vectors</a></li>
<li class="chapter" data-level="B.5.2" data-path="setting-up-the-r-environment.html"><a href="setting-up-the-r-environment.html#basic-plotting"><i class="fa fa-check"></i><b>B.5.2</b> Basic Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html"><i class="fa fa-check"></i><b>C</b> Vector Algebra in R</a><ul>
<li class="chapter" data-level="C.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#motivation-1"><i class="fa fa-check"></i><b>C.1</b> Motivation</a></li>
<li class="chapter" data-level="C.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#numeric-vectors"><i class="fa fa-check"></i><b>C.2</b> Numeric Vectors</a><ul>
<li class="chapter" data-level="C.2.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-numeric-vectors"><i class="fa fa-check"></i><b>C.2.1</b> Creating Numeric Vectors</a></li>
<li class="chapter" data-level="C.2.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-scalar-operations"><i class="fa fa-check"></i><b>C.2.2</b> Vector-Scalar Operations</a></li>
<li class="chapter" data-level="C.2.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-vector-operations"><i class="fa fa-check"></i><b>C.2.3</b> Vector-Vector Operations</a></li>
<li class="chapter" data-level="C.2.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#aggregation-functions"><i class="fa fa-check"></i><b>C.2.4</b> Aggregation Functions</a></li>
<li class="chapter" data-level="C.2.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#special-functions"><i class="fa fa-check"></i><b>C.2.5</b> Special Functions</a></li>
<li class="chapter" data-level="C.2.6" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#norms-and-distances"><i class="fa fa-check"></i><b>C.2.6</b> Norms and Distances</a></li>
<li class="chapter" data-level="C.2.7" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#dot-product"><i class="fa fa-check"></i><b>C.2.7</b> Dot Product (*)</a></li>
<li class="chapter" data-level="C.2.8" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#missing-and-other-special-values"><i class="fa fa-check"></i><b>C.2.8</b> Missing and Other Special Values</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#logical-vectors"><i class="fa fa-check"></i><b>C.3</b> Logical Vectors</a><ul>
<li class="chapter" data-level="C.3.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-logical-vectors"><i class="fa fa-check"></i><b>C.3.1</b> Creating Logical Vectors</a></li>
<li class="chapter" data-level="C.3.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#logical-operations"><i class="fa fa-check"></i><b>C.3.2</b> Logical Operations</a></li>
<li class="chapter" data-level="C.3.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#comparison-operations"><i class="fa fa-check"></i><b>C.3.3</b> Comparison Operations</a></li>
<li class="chapter" data-level="C.3.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#aggregation-functions-1"><i class="fa fa-check"></i><b>C.3.4</b> Aggregation Functions</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#character-vectors"><i class="fa fa-check"></i><b>C.4</b> Character Vectors</a><ul>
<li class="chapter" data-level="C.4.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-character-vectors"><i class="fa fa-check"></i><b>C.4.1</b> Creating Character Vectors</a></li>
<li class="chapter" data-level="C.4.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#concatenating-character-vectors"><i class="fa fa-check"></i><b>C.4.2</b> Concatenating Character Vectors</a></li>
<li class="chapter" data-level="C.4.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#collapsing-character-vectors"><i class="fa fa-check"></i><b>C.4.3</b> Collapsing Character Vectors</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#vector-subsetting"><i class="fa fa-check"></i><b>C.5</b> Vector Subsetting</a><ul>
<li class="chapter" data-level="C.5.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-positive-indices"><i class="fa fa-check"></i><b>C.5.1</b> Subsetting with Positive Indices</a></li>
<li class="chapter" data-level="C.5.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-negative-indices"><i class="fa fa-check"></i><b>C.5.2</b> Subsetting with Negative Indices</a></li>
<li class="chapter" data-level="C.5.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-with-logical-vectors"><i class="fa fa-check"></i><b>C.5.3</b> Subsetting with Logical Vectors</a></li>
<li class="chapter" data-level="C.5.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#replacing-elements"><i class="fa fa-check"></i><b>C.5.4</b> Replacing Elements</a></li>
<li class="chapter" data-level="C.5.5" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#other-functions"><i class="fa fa-check"></i><b>C.5.5</b> Other Functions</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#named-vectors"><i class="fa fa-check"></i><b>C.6</b> Named Vectors</a><ul>
<li class="chapter" data-level="C.6.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-named-vectors"><i class="fa fa-check"></i><b>C.6.1</b> Creating Named Vectors</a></li>
<li class="chapter" data-level="C.6.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-named-vectors-with-character-string-indices"><i class="fa fa-check"></i><b>C.6.2</b> Subsetting Named Vectors with Character String Indices</a></li>
</ul></li>
<li class="chapter" data-level="C.7" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#factors"><i class="fa fa-check"></i><b>C.7</b> Factors</a><ul>
<li class="chapter" data-level="C.7.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-factors"><i class="fa fa-check"></i><b>C.7.1</b> Creating Factors</a></li>
<li class="chapter" data-level="C.7.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#levels"><i class="fa fa-check"></i><b>C.7.2</b> Levels</a></li>
<li class="chapter" data-level="C.7.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#internal-representation"><i class="fa fa-check"></i><b>C.7.3</b> Internal Representation (*)</a></li>
</ul></li>
<li class="chapter" data-level="C.8" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#lists"><i class="fa fa-check"></i><b>C.8</b> Lists</a><ul>
<li class="chapter" data-level="C.8.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#creating-lists"><i class="fa fa-check"></i><b>C.8.1</b> Creating Lists</a></li>
<li class="chapter" data-level="C.8.2" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#named-lists"><i class="fa fa-check"></i><b>C.8.2</b> Named Lists</a></li>
<li class="chapter" data-level="C.8.3" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#subsetting-and-extracting-from-lists"><i class="fa fa-check"></i><b>C.8.3</b> Subsetting and Extracting From Lists</a></li>
<li class="chapter" data-level="C.8.4" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#common-operations"><i class="fa fa-check"></i><b>C.8.4</b> Common Operations</a></li>
</ul></li>
<li class="chapter" data-level="C.9" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#exercises-7"><i class="fa fa-check"></i><b>C.9</b> Exercises</a><ul>
<li class="chapter" data-level="C.9.1" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#audeur-exchange-rates"><i class="fa fa-check"></i><b>C.9.1</b> AUD/EUR Exchange Rates</a></li>
</ul></li>
<li class="chapter" data-level="C.10" data-path="vector-algebra-in-r.html"><a href="vector-algebra-in-r.html#further-reading-11"><i class="fa fa-check"></i><b>C.10</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html"><i class="fa fa-check"></i><b>D</b> Matrix Algebra in R</a><ul>
<li class="chapter" data-level="D.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#creating-matrices"><i class="fa fa-check"></i><b>D.1</b> Creating Matrices</a><ul>
<li class="chapter" data-level="D.1.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix"><i class="fa fa-check"></i><b>D.1.1</b> <code>matrix()</code></a></li>
<li class="chapter" data-level="D.1.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#stacking-vectors"><i class="fa fa-check"></i><b>D.1.2</b> Stacking Vectors</a></li>
<li class="chapter" data-level="D.1.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#beyond-numeric-matrices"><i class="fa fa-check"></i><b>D.1.3</b> Beyond Numeric Matrices</a></li>
<li class="chapter" data-level="D.1.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#naming-rows-and-columns"><i class="fa fa-check"></i><b>D.1.4</b> Naming Rows and Columns</a></li>
<li class="chapter" data-level="D.1.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#other-methods"><i class="fa fa-check"></i><b>D.1.5</b> Other Methods</a></li>
<li class="chapter" data-level="D.1.6" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#internal-representation-1"><i class="fa fa-check"></i><b>D.1.6</b> Internal Representation (*)</a></li>
</ul></li>
<li class="chapter" data-level="D.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#common-operations-1"><i class="fa fa-check"></i><b>D.2</b> Common Operations</a><ul>
<li class="chapter" data-level="D.2.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-transpose"><i class="fa fa-check"></i><b>D.2.1</b> Matrix Transpose</a></li>
<li class="chapter" data-level="D.2.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-scalar-operations"><i class="fa fa-check"></i><b>D.2.2</b> Matrix-Scalar Operations</a></li>
<li class="chapter" data-level="D.2.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-matrix-operations"><i class="fa fa-check"></i><b>D.2.3</b> Matrix-Matrix Operations</a></li>
<li class="chapter" data-level="D.2.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-multiplication"><i class="fa fa-check"></i><b>D.2.4</b> Matrix Multiplication (*)</a></li>
<li class="chapter" data-level="D.2.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#aggregation-of-rows-and-columns"><i class="fa fa-check"></i><b>D.2.5</b> Aggregation of Rows and Columns</a></li>
<li class="chapter" data-level="D.2.6" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#vectorised-special-functions"><i class="fa fa-check"></i><b>D.2.6</b> Vectorised Special Functions</a></li>
<li class="chapter" data-level="D.2.7" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-vector-operations"><i class="fa fa-check"></i><b>D.2.7</b> Matrix-Vector Operations</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#matrix-subsetting"><i class="fa fa-check"></i><b>D.3</b> Matrix Subsetting</a><ul>
<li class="chapter" data-level="D.3.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-individual-elements"><i class="fa fa-check"></i><b>D.3.1</b> Selecting Individual Elements</a></li>
<li class="chapter" data-level="D.3.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-rows-and-columns"><i class="fa fa-check"></i><b>D.3.2</b> Selecting Rows and Columns</a></li>
<li class="chapter" data-level="D.3.3" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-submatrices"><i class="fa fa-check"></i><b>D.3.3</b> Selecting Submatrices</a></li>
<li class="chapter" data-level="D.3.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-based-on-logical-vectors-and-matrices"><i class="fa fa-check"></i><b>D.3.4</b> Selecting Based on Logical Vectors and Matrices</a></li>
<li class="chapter" data-level="D.3.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#selecting-based-on-two-column-matrices"><i class="fa fa-check"></i><b>D.3.5</b> Selecting Based on Two-Column Matrices</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#exercises-8"><i class="fa fa-check"></i><b>D.4</b> Exercises</a><ul>
<li class="chapter" data-level="D.4.1" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#currency-exchange-rates"><i class="fa fa-check"></i><b>D.4.1</b> Currency Exchange Rates</a></li>
<li class="chapter" data-level="D.4.2" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#currency-exchange-rates-relative-to-1999"><i class="fa fa-check"></i><b>D.4.2</b> Currency Exchange Rates Relative to 1999</a></li>
</ul></li>
<li class="chapter" data-level="D.5" data-path="matrix-algebra-in-r.html"><a href="matrix-algebra-in-r.html#further-reading-12"><i class="fa fa-check"></i><b>D.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html"><i class="fa fa-check"></i><b>E</b> Data Frame Wrangling in R</a><ul>
<li class="chapter" data-level="E.1" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#creating-data-frames"><i class="fa fa-check"></i><b>E.1</b> Creating Data Frames</a></li>
<li class="chapter" data-level="E.2" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#importing-data-frames"><i class="fa fa-check"></i><b>E.2</b> Importing Data Frames</a></li>
<li class="chapter" data-level="E.3" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#data-frame-subsetting"><i class="fa fa-check"></i><b>E.3</b> Data Frame Subsetting</a><ul>
<li class="chapter" data-level="E.3.1" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#each-data-frame-is-a-list"><i class="fa fa-check"></i><b>E.3.1</b> Each Data Frame is a List</a></li>
<li class="chapter" data-level="E.3.2" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#each-data-frame-is-matrix-like"><i class="fa fa-check"></i><b>E.3.2</b> Each Data Frame is Matrix-like</a></li>
</ul></li>
<li class="chapter" data-level="E.4" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#common-operations-2"><i class="fa fa-check"></i><b>E.4</b> Common Operations</a></li>
<li class="chapter" data-level="E.5" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#metaprogramming-and-formulas"><i class="fa fa-check"></i><b>E.5</b> Metaprogramming and Formulas (*)</a></li>
<li class="chapter" data-level="E.6" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#exercises-9"><i class="fa fa-check"></i><b>E.6</b> Exercises</a><ul>
<li class="chapter" data-level="E.6.1" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#urban-forest"><i class="fa fa-check"></i><b>E.6.1</b> Urban Forest</a></li>
</ul></li>
<li class="chapter" data-level="E.7" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#air-quality"><i class="fa fa-check"></i><b>E.7</b> Air Quality</a></li>
<li class="chapter" data-level="E.8" data-path="data-frame-wrangling-in-r.html"><a href="data-frame-wrangling-in-r.html#further-reading-13"><i class="fa fa-check"></i><b>E.8</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="datasets.html"><a href="datasets.html"><i class="fa fa-check"></i><b>F</b> Datasets</a><ul>
<li class="chapter" data-level="F.1" data-path="datasets.html"><a href="datasets.html#air-quality-1"><i class="fa fa-check"></i><b>F.1</b> Air Quality</a></li>
<li class="chapter" data-level="F.2" data-path="datasets.html"><a href="datasets.html#currency-exchange-rates-1"><i class="fa fa-check"></i><b>F.2</b> Currency Exchange Rates</a></li>
<li class="chapter" data-level="F.3" data-path="datasets.html"><a href="datasets.html#urban-forest-1"><i class="fa fa-check"></i><b>F.3</b> Urban Forest</a></li>
<li class="chapter" data-level="F.4" data-path="datasets.html"><a href="datasets.html#wine-quality"><i class="fa fa-check"></i><b>F.4</b> Wine Quality</a></li>
<li class="chapter" data-level="F.5" data-path="datasets.html"><a href="datasets.html#the-world-factbook-countries-of-the-world"><i class="fa fa-check"></i><b>F.5</b> The World Factbook (Countries of the World)</a></li>
<li class="chapter" data-level="F.6" data-path="datasets.html"><a href="datasets.html#edstats-country-level-education-statistics"><i class="fa fa-check"></i><b>F.6</b> EdStats (Country-Level Education Statistics)</a></li>
<li class="chapter" data-level="F.7" data-path="datasets.html"><a href="datasets.html#food-and-nutrient-database-for-dietary-studies-fndds"><i class="fa fa-check"></i><b>F.7</b> Food and Nutrient Database for Dietary Studies (FNDDS)</a></li>
<li class="chapter" data-level="F.8" data-path="datasets.html"><a href="datasets.html#clustering-benchmarks"><i class="fa fa-check"></i><b>F.8</b> Clustering Benchmarks</a></li>
<li class="chapter" data-level="F.9" data-path="datasets.html"><a href="datasets.html#movie-lens-todo"><i class="fa fa-check"></i><b>F.9</b> Movie Lens (TODO)</a></li>
<li class="chapter" data-level="F.10" data-path="datasets.html"><a href="datasets.html#other-todo"><i class="fa fa-check"></i><b>F.10</b> Other (TODO)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li style='font-size: smaller' ><a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Licensed under CC BY-NC-ND 4.0</a></li>
<li style='font-size: smaller' ><a href="./">DRAFT v0.3 2020-06-08 21:11 (2ec3f97)</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Lightweight Machine Learning Classics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="classification-with-linear-models" class="section level1">
<h1><span class="header-section-number">6</span> Classification with Linear Models</h1>
<!-- (C) 2020 Marek Gagolewski, https://www.gagolewski.com -->
<!-- TODO: citations

*Random Forests* and *XGBoost* (see also: *AdaBoost*)
SVMs
-->
<div id="introduction-8" class="section level2">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<div id="classification-task-2" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Classification Task</h3>
<p>Let <span class="math inline">\(\mathbf{X}\in\mathbb{R}^{n\times p}\)</span> be an input matrix
that consists of <span class="math inline">\(n\)</span> points in a <span class="math inline">\(p\)</span>-dimensional space (each of the <span class="math inline">\(n\)</span> objects
is described by means of <span class="math inline">\(p\)</span> numerical features)</p>
<p>Recall that in supervised learning, with each
<span class="math inline">\(\mathbf{x}_{i,\cdot}\)</span> we associate the desired output <span class="math inline">\(y_i\)</span>.</p>
<p>Hence, our dataset is <span class="math inline">\([\mathbf{X}\ \mathbf{y}]\)</span> –
where each object is represented as a row vector
<span class="math inline">\([\mathbf{x}_{i,\cdot}\ y_i]\)</span>, <span class="math inline">\(i=1,\dots,n\)</span>:</p>
<p><span class="math display">\[
[\mathbf{X}\ \mathbf{y}]=
\left[
\begin{array}{ccccc}
x_{1,1} &amp; x_{1,2} &amp; \cdots &amp; x_{1,p} &amp; y_1\\
x_{2,1} &amp; x_{2,2} &amp; \cdots &amp; x_{2,p} &amp; y_2\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots    &amp; \vdots\\
x_{n,1} &amp; x_{n,2} &amp; \cdots &amp; x_{n,p} &amp; y_n\\
\end{array}
\right].
\]</span></p>
<div style="margin-top: 1em">

</div>
<p>In this chapter we are still interested in <strong>classification</strong> tasks;
we assume that each <span class="math inline">\(y_i\)</span> is a descriptive label.</p>
<p>Let’s assume that we are faced with <strong>binary classification</strong> tasks.</p>
<p>Hence, there are only two possible labels that we traditionally denote with <span class="math inline">\(0\)</span>s and <span class="math inline">\(1\)</span>s.</p>
<p>For example:</p>
<table>
<thead>
<tr class="header">
<th>0</th>
<th>1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>no</td>
<td>yes</td>
</tr>
<tr class="even">
<td>false</td>
<td>true</td>
</tr>
<tr class="odd">
<td>failure</td>
<td>success</td>
</tr>
<tr class="even">
<td>healthy</td>
<td>ill</td>
</tr>
</tbody>
</table>
<p>Let’s recall the synthetic 2D dataset from the previous chapter
(true decision boundary is at <span class="math inline">\(X_1=0\)</span>), see Figure <a href="classification-with-linear-models.html#fig:synthetic2">1</a>.</p>
<div class="figure">
<img src="06-logistic-figures/synthetic2-1.svg" alt="Figure 1: A synthetic 2D dataset with the true decision boundary at X_1=0" id="fig:synthetic2" />
<p class="caption">Figure 1: A synthetic 2D dataset with the true decision boundary at <span class="math inline">\(X_1=0\)</span></p>
</div>
</div>
<div id="data-2" class="section level3">
<h3><span class="header-section-number">6.1.2</span> Data</h3>
<p>For illustration, we’ll be considering the Wine Quality dataset
(white wines only):</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb460-1" title="1">wine_quality &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;datasets/wine_quality_all.csv&quot;</span>,</a>
<a class="sourceLine" id="cb460-2" title="2">    <span class="dt">comment.char=</span><span class="st">&quot;#&quot;</span>)</a>
<a class="sourceLine" id="cb460-3" title="3">white_wines &lt;-<span class="st"> </span>wine_quality[wine_quality<span class="op">$</span>color <span class="op">==</span><span class="st"> &quot;white&quot;</span>,]</a>
<a class="sourceLine" id="cb460-4" title="4">(n &lt;-<span class="st"> </span><span class="kw">nrow</span>(white_wines)) <span class="co"># number of samples</span></a></code></pre></div>
<pre><code>## [1] 4898</code></pre>
<p>The input matrix <span class="math inline">\(\mathbf{X}\in\mathbb{R}^{n\times p}\)</span>
consists of the first 10 numeric variables:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb462-1" title="1">X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(white_wines[,<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>])</a>
<a class="sourceLine" id="cb462-2" title="2"><span class="kw">dim</span>(X)</a></code></pre></div>
<pre><code>## [1] 4898   10</code></pre>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb464-1" title="1"><span class="kw">head</span>(X, <span class="dv">2</span>) <span class="co"># first two rows</span></a></code></pre></div>
<pre><code>##      fixed.acidity volatile.acidity citric.acid residual.sugar
## 1600           7.0             0.27        0.36           20.7
## 1601           6.3             0.30        0.34            1.6
##      chlorides free.sulfur.dioxide total.sulfur.dioxide density  pH
## 1600     0.045                  45                  170   1.001 3.0
## 1601     0.049                  14                  132   0.994 3.3
##      sulphates
## 1600      0.45
## 1601      0.49</code></pre>
<p>The 11th variable measures the amount of alcohol (in %).</p>
<p>We will convert this dependent variable to a binary one:</p>
<ul>
<li>0 == (<code>alcohol  &lt; 12</code>) == lower-alcohol wines,</li>
<li>1 == (<code>alcohol &gt;= 12</code>) == higher-alcohol wines</li>
</ul>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb466-1" title="1"><span class="co"># recall that TRUE == 1</span></a>
<a class="sourceLine" id="cb466-2" title="2">Y &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">as.character</span>(<span class="kw">as.numeric</span>(white_wines<span class="op">$</span>alcohol <span class="op">&gt;=</span><span class="st"> </span><span class="dv">12</span>)))</a>
<a class="sourceLine" id="cb466-3" title="3"><span class="kw">table</span>(Y)</a></code></pre></div>
<pre><code>## Y
##    0    1 
## 4085  813</code></pre>
<p>60/40% train-test split:</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb468-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co"># reproducibility matters</span></a>
<a class="sourceLine" id="cb468-2" title="2">random_indices &lt;-<span class="st"> </span><span class="kw">sample</span>(n)</a>
<a class="sourceLine" id="cb468-3" title="3"><span class="kw">head</span>(random_indices) <span class="co"># preview</span></a></code></pre></div>
<pre><code>## [1] 2463 2511 2227  526 4291 2986</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" title="1"><span class="co"># first 60% of the indices (they are arranged randomly)</span></a>
<a class="sourceLine" id="cb470-2" title="2"><span class="co"># will constitute the train sample:</span></a>
<a class="sourceLine" id="cb470-3" title="3">train_indices &lt;-<span class="st"> </span>random_indices[<span class="dv">1</span><span class="op">:</span><span class="kw">floor</span>(n<span class="op">*</span><span class="fl">0.6</span>)]</a>
<a class="sourceLine" id="cb470-4" title="4">X_train &lt;-<span class="st"> </span>X[train_indices,]</a>
<a class="sourceLine" id="cb470-5" title="5">Y_train &lt;-<span class="st"> </span>Y[train_indices]</a>
<a class="sourceLine" id="cb470-6" title="6"><span class="co"># the remaining indices (40%) go to the test sample:</span></a>
<a class="sourceLine" id="cb470-7" title="7">X_test  &lt;-<span class="st"> </span>X[<span class="op">-</span>train_indices,]</a>
<a class="sourceLine" id="cb470-8" title="8">Y_test  &lt;-<span class="st"> </span>Y[<span class="op">-</span>train_indices]</a></code></pre></div>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1">XY_train &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(X_train), <span class="dt">Y=</span>Y_train)</a>
<a class="sourceLine" id="cb471-2" title="2">XY_test &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(X_test), <span class="dt">Y=</span>Y_test)</a></code></pre></div>
<p>Let’s also compute <code>Z_train</code> and <code>Z_test</code>, being the standardised versions of <code>X_train</code>
and <code>X_test</code>, respectively.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" title="1">means &lt;-<span class="st"> </span><span class="kw">apply</span>(X_train, <span class="dv">2</span>, mean) <span class="co"># column means</span></a>
<a class="sourceLine" id="cb472-2" title="2">sds   &lt;-<span class="st"> </span><span class="kw">apply</span>(X_train, <span class="dv">2</span>, sd)   <span class="co"># column standard deviations</span></a>
<a class="sourceLine" id="cb472-3" title="3">Z_train &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X_train, <span class="dv">1</span>, <span class="cf">function</span>(r) (r<span class="op">-</span>means)<span class="op">/</span>sds))</a>
<a class="sourceLine" id="cb472-4" title="4">Z_test  &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X_test,  <span class="dv">1</span>, <span class="cf">function</span>(r) (r<span class="op">-</span>means)<span class="op">/</span>sds))</a></code></pre></div>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1">get_metrics &lt;-<span class="st"> </span><span class="cf">function</span>(Y_pred, Y_test)</a>
<a class="sourceLine" id="cb473-2" title="2">{</a>
<a class="sourceLine" id="cb473-3" title="3">    C &lt;-<span class="st"> </span><span class="kw">table</span>(Y_pred, Y_test) <span class="co"># confusion matrix</span></a>
<a class="sourceLine" id="cb473-4" title="4">    <span class="kw">stopifnot</span>(<span class="kw">dim</span>(C) <span class="op">==</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb473-5" title="5">    <span class="kw">c</span>(<span class="dt">Acc=</span>(C[<span class="dv">1</span>,<span class="dv">1</span>]<span class="op">+</span>C[<span class="dv">2</span>,<span class="dv">2</span>])<span class="op">/</span><span class="kw">sum</span>(C), <span class="co"># accuracy</span></a>
<a class="sourceLine" id="cb473-6" title="6">      <span class="dt">Prec=</span>C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span>(C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">+</span>C[<span class="dv">2</span>,<span class="dv">1</span>]), <span class="co"># precision</span></a>
<a class="sourceLine" id="cb473-7" title="7">      <span class="dt">Rec=</span>C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span>(C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">+</span>C[<span class="dv">1</span>,<span class="dv">2</span>]), <span class="co"># recall</span></a>
<a class="sourceLine" id="cb473-8" title="8">      <span class="dt">F=</span>C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">/</span>(C[<span class="dv">2</span>,<span class="dv">2</span>]<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>C[<span class="dv">1</span>,<span class="dv">2</span>]<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span>C[<span class="dv">2</span>,<span class="dv">1</span>]), <span class="co"># F-measure</span></a>
<a class="sourceLine" id="cb473-9" title="9">      <span class="co"># Confusion matrix items:</span></a>
<a class="sourceLine" id="cb473-10" title="10">      <span class="dt">TN=</span>C[<span class="dv">1</span>,<span class="dv">1</span>], <span class="dt">FN=</span>C[<span class="dv">1</span>,<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb473-11" title="11">      <span class="dt">FP=</span>C[<span class="dv">2</span>,<span class="dv">1</span>], <span class="dt">TP=</span>C[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb473-12" title="12">    ) <span class="co"># return a named vector</span></a>
<a class="sourceLine" id="cb473-13" title="13">}</a></code></pre></div>
</div>
</div>
<div id="binary-logistic-regression" class="section level2">
<h2><span class="header-section-number">6.2</span> Binary Logistic Regression</h2>
<div id="motivation" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Motivation</h3>
<p>Recall that for a regression task, we fitted a very simple family of models
– the linear ones – by minimising the sum of squared residuals.</p>
<p>This approach was pretty effective.</p>
<p>(Very) theoretically, we could treat the class labels as numeric <span class="math inline">\(0\)</span>s and <span class="math inline">\(1\)</span>s
and apply regression models in a binary classification task.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1">XY_train_r &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(X_train),</a>
<a class="sourceLine" id="cb474-2" title="2">    <span class="dt">Y=</span><span class="kw">as.numeric</span>(Y_train)<span class="op">-</span><span class="dv">1</span> <span class="co"># 0.0 or 1.0</span></a>
<a class="sourceLine" id="cb474-3" title="3">)</a>
<a class="sourceLine" id="cb474-4" title="4">XY_test_r &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">as.data.frame</span>(X_test),</a>
<a class="sourceLine" id="cb474-5" title="5">    <span class="dt">Y=</span><span class="kw">as.numeric</span>(Y_test)<span class="op">-</span><span class="dv">1</span> <span class="co"># 0.0 or 1.0</span></a>
<a class="sourceLine" id="cb474-6" title="6">)</a>
<a class="sourceLine" id="cb474-7" title="7">f_r &lt;-<span class="st"> </span><span class="kw">lm</span>(Y<span class="op">~</span>density<span class="op">+</span>residual.sugar<span class="op">+</span>pH, <span class="dt">data=</span>XY_train_r)</a></code></pre></div>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1">Y_pred_r &lt;-<span class="st"> </span><span class="kw">predict</span>(f_r, XY_test_r)</a>
<a class="sourceLine" id="cb475-2" title="2"><span class="kw">summary</span>(Y_pred_r)</a></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
## -3.0468 -0.0211  0.1192  0.1645  0.3491  0.8892</code></pre>
<p>The predicted outputs, <span class="math inline">\(\hat{Y}\)</span>, are arbitrary real numbers,
but we can convert them to binary ones by checking if, e.g., <span class="math inline">\(\hat{Y}&gt;0.5\)</span>.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(Y_pred_r<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="kw">round</span>(<span class="kw">get_metrics</span>(Y_pred, XY_test_r<span class="op">$</span>Y), <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##      Acc     Prec      Rec        F       TN       FN       FP       TP 
##    0.927    0.865    0.647    0.740 1611.000  112.000   32.000  205.000</code></pre>
<dl>
<dt>Remark.</dt>
<dd><p>(*) The threshold <span class="math inline">\(T=0.5\)</span> could even be treated as a free parameter
we optimise for (w.r.t. different metrics over the validation sample),
see Figure <a href="classification-with-linear-models.html#fig:lm3b">2</a>.</p>
</dd>
</dl>
<div class="figure">
<img src="06-logistic-figures/lm3b-1.svg" alt="Figure 2: Quality metrics for a binary classifier “Classify X as 1 if f(X)&gt;T and as 0 if f(X)\le T”" id="fig:lm3b" />
<p class="caption">Figure 2: Quality metrics for a binary classifier “Classify X as 1 if <span class="math inline">\(f(X)&gt;T\)</span> and as 0 if <span class="math inline">\(f(X)\le T\)</span>”</p>
</div>
<p>Despite we can, we shouldn’t use linear regression for classification.
Treating class labels “0” and “1” as ordinary real numbers just doesn’t
cut it – we intuitively feel that we are doing something <em>ugly</em>.
Luckily, there is a better, more meaningful approach that
still relies on a linear model, but has the <em>right</em> semantics.</p>
</div>
<div id="logistic-model" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Logistic Model</h3>
<p>Inspired by this idea, we could try modelling
the <strong><em>probability</em> that a given point belongs to class <span class="math inline">\(1\)</span></strong>.</p>
<p>This could also provide us with the <em>confidence</em> in our prediction.</p>
<p>Probability is a number in <span class="math inline">\([0,1]\)</span>, but the outputs of a linear model are arbitrary real numbers.</p>
<p>However, we could transform those real-valued outputs by means
of some function <span class="math inline">\(\phi:\mathbb{R}\to[0,1]\)</span> (preferably S-shaped == sigmoid),
so as to get:</p>
<p><span class="math display">\[
\Pr(Y=1|\mathbf{X},\boldsymbol\beta)=\phi(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p).
\]</span></p>
<dl>
<dt>Remark.</dt>
<dd><p>The above reads as “Probability that <span class="math inline">\(Y\)</span> is from class 1 given <span class="math inline">\(\mathbf{X}\)</span>
and <span class="math inline">\(\boldsymbol\beta\)</span>”.</p>
</dd>
</dl>
<p>A popular choice is the <strong>logistic sigmoid function</strong>,
see Figure <a href="classification-with-linear-models.html#fig:sigmoid">3</a>:</p>
<p><span class="math display">\[
\phi(t) = \frac{1}{1+e^{-t}} = \frac{e^t}{1+e^t}.
\]</span></p>
<div class="figure">
<img src="06-logistic-figures/sigmoid-1.svg" alt="Figure 3: The logistic sigmoid function, \varphi" id="fig:sigmoid" />
<p class="caption">Figure 3: The logistic sigmoid function, <span class="math inline">\(\varphi\)</span></p>
</div>
<p>Hence our model becomes:</p>
<p><span class="math display">\[
Y=\frac{1}{1+e^{-(\beta_0 + \beta_1 X_1 + \beta_2 X_2 + \dots + \beta_p X_p)}}
\]</span></p>
<p>It is an instance of a <strong>generalised linear model</strong> (glm)
(there are of course many other possible generalisations).</p>
</div>
<div id="example-in-r-2" class="section level3">
<h3><span class="header-section-number">6.2.3</span> Example in R</h3>
<p>Let us first fit a simple (i.e., <span class="math inline">\(p=1\)</span>) logistic regression model
using the <code>density</code> variable. The goodness-of-fit measure used in this
problem will be discussed a bit later.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1">(f &lt;-<span class="st"> </span><span class="kw">glm</span>(Y<span class="op">~</span>density, <span class="dt">data=</span>XY_train, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)))</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Y ~ density, family = binomial(&quot;logit&quot;), data = XY_train)
## 
## Coefficients:
## (Intercept)      density  
##        1173        -1184  
## 
## Degrees of Freedom: 2937 Total (i.e. Null);  2936 Residual
## Null Deviance:       2670 
## Residual Deviance: 1420  AIC: 1420</code></pre>
<p>“logit” above denotes the inverse of the logistic sigmoid function.
The fitted coefficients are equal to:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1">f<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>## (Intercept)     density 
##      1173.2     -1184.2</code></pre>
<p>Figure <a href="classification-with-linear-models.html#fig:glm2">4</a> depicts the obtained model, which can be written
as:
<span class="math display">\[
\Pr(Y=1|x)=\displaystyle\frac{1}{1+e^{-\left(
1173.21-1184.21x
\right)}
}
\]</span>
with <span class="math inline">\(x=\text{density}\)</span>.</p>
<div class="figure">
<img src="06-logistic-figures/glm2-1.svg" alt="Figure 4: The probability that a given wine is a high-alcohol one given its density; black and red points denote the actual observed data points from the class 0 and 1, respectively" id="fig:glm2" />
<p class="caption">Figure 4: The probability that a given wine is a high-alcohol one given its density; black and red points denote the actual observed data points from the class 0 and 1, respectively</p>
</div>
<p>Some predicted probabilities:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb483-1" title="1"><span class="kw">round</span>(<span class="kw">head</span>(<span class="kw">predict</span>(f, XY_test, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>), <span class="dv">12</span>), <span class="dv">2</span>)</a></code></pre></div>
<pre><code>## 1602 1605 1607 1608 1609 1613 1614 1615 1621 1622 1623 1627 
## 0.01 0.01 0.00 0.02 0.03 0.36 0.00 0.31 0.36 0.06 0.03 0.00</code></pre>
<p>We classify <span class="math inline">\(Y\)</span> as 1 if the corresponding membership probability
is greater than <span class="math inline">\(0.5\)</span>.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f, XY_test, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb485-2" title="2"><span class="kw">get_metrics</span>(Y_pred, Y_test)</a></code></pre></div>
<pre><code>##        Acc       Prec        Rec          F         TN         FN 
##    0.89796    0.72763    0.58991    0.65157 1573.00000  130.00000 
##         FP         TP 
##   70.00000  187.00000</code></pre>
<p>And now a fit based on some other input variables:</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" title="1">(f &lt;-<span class="st"> </span><span class="kw">glm</span>(Y<span class="op">~</span>density<span class="op">+</span>residual.sugar<span class="op">+</span>total.sulfur.dioxide,</a>
<a class="sourceLine" id="cb487-2" title="2">    <span class="dt">data=</span>XY_train, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)))</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = Y ~ density + residual.sugar + total.sulfur.dioxide, 
##     family = binomial(&quot;logit&quot;), data = XY_train)
## 
## Coefficients:
##          (Intercept)               density        residual.sugar  
##             2.50e+03             -2.53e+03              8.58e-01  
## total.sulfur.dioxide  
##             9.74e-03  
## 
## Degrees of Freedom: 2937 Total (i.e. Null);  2934 Residual
## Null Deviance:       2670 
## Residual Deviance: 920   AIC: 928</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb489-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f, XY_test, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb489-2" title="2"><span class="kw">get_metrics</span>(Y_pred, Y_test)</a></code></pre></div>
<pre><code>##        Acc       Prec        Rec          F         TN         FN 
##    0.93214    0.82394    0.73817    0.77870 1593.00000   83.00000 
##         FP         TP 
##   50.00000  234.00000</code></pre>
<div class="exercise"><strong>Exercise.</strong>
<p>Try fitting different models based on other sets of features.</p>
</div>
</div>
<div id="loss-function-cross-entropy" class="section level3">
<h3><span class="header-section-number">6.2.4</span> Loss Function: Cross-entropy</h3>
<p>The fitting of the model can be written as an optimisation task:</p>
<p><span class="math display">\[
\min_{\beta_0, \beta_1,\dots, \beta_p\in\mathbb{R}}
\frac{1}{n} \sum_{i=1}^n
\epsilon\left(\hat{y}_i, y_i \right)
\]</span></p>
<p>where <span class="math inline">\(\epsilon(\hat{y}_i, y_i)\)</span> denotes the penalty that measures the
“difference” between the true <span class="math inline">\(y_i\)</span> and its predicted version
<span class="math inline">\(\hat{y}_i=\Pr(Y=1|\mathbf{x}_{i,\cdot},\boldsymbol\beta)\)</span>.</p>
<p>In the ordinary regression, we used the squared residual
<span class="math inline">\(\epsilon(\hat{y}_i, y_i) = (\hat{y}_i-y_i)^2\)</span>.
In <strong>logistic regression</strong> (the kind of a classifier we are
interested in right now), we use
the <strong>cross-entropy</strong> (a.k.a. <strong>log-loss</strong>, binary cross-entropy),</p>
<p><span class="math display">\[
\epsilon(\hat{y}_i,y_i) = - \left(y_i \log \hat{y}_i + (1-y_i) \log(1-\hat{y}_i)\right)
\]</span></p>
<p>The corresponding loss function has not only
many nice statistical properties (** related to maximum likelihood
estimation etc.)
but also an intuitive interpretation.</p>
<p>Note that the predicted <span class="math inline">\(\hat{y}_i\)</span> is in <span class="math inline">\((0,1)\)</span> and the true <span class="math inline">\(y_i\)</span>
equals to either 0 or 1.
Recall also that <span class="math inline">\(\log t\in(-\infty, 0)\)</span> for <span class="math inline">\(t\in (0,1)\)</span>.
Therefore, the formula for <span class="math inline">\(\epsilon(\hat{y}_i,y_i)\)</span>
has a very intuitive behaviour:</p>
<ul>
<li><p>if true <span class="math inline">\(y_i=1\)</span>, then the penalty becomes <span class="math inline">\(\epsilon(\hat{y}_i, 1) = -\log(\hat{y}_i)\)</span></p>
<ul>
<li><span class="math inline">\(\hat{y}_i\)</span> is the probability that the classified input is indeed from class <span class="math inline">\(1\)</span></li>
<li>we’d be happy if the classifier outputted <span class="math inline">\(\hat{y}_i\simeq 1\)</span> in this case;
this is not penalised as <span class="math inline">\(-\log(t)\to 0\)</span> as <span class="math inline">\(t\to 1\)</span></li>
<li>however, if the classifier is totally wrong, i.e., it thinks that
<span class="math inline">\(\hat{y}_i\simeq 0\)</span>, then the penalty will be very high, as <span class="math inline">\(-\log(t)\to+\infty\)</span>
as <span class="math inline">\(t\to 0\)</span></li>
</ul></li>
<li><p>if true <span class="math inline">\(y_i=0\)</span>, then the penalty becomes <span class="math inline">\(\epsilon(\hat{y}_i, 0) = -\log(1-\hat{y}_i)\)</span></p>
<ul>
<li><span class="math inline">\(1-\hat{y}_i\)</span> is the predicted probability that the input is from class <span class="math inline">\(0\)</span></li>
<li>we penalise heavily the case where <span class="math inline">\(1-\hat{y}_i\)</span> is small (we’d be happy
if the classifier was sure that <span class="math inline">\(1-\hat{y}_i\simeq 1\)</span>, because this is the ground-truth)</li>
</ul></li>
</ul>
<div style="margin-top: 1em">

</div>
<p>(*) Having said that, let’s expand the above formulae.
The task of minimising cross-entropy in the binary logistic regression
can be written as <span class="math inline">\(\min_{\boldsymbol\beta\in\mathbb{R}^{p+1}} E(\boldsymbol\beta)\)</span>
with:</p>
<p><span class="math display">\[
E(\boldsymbol\beta)=
-\frac{1}{n} \sum_{i=1}^n
y_i \log \Pr(Y=1|\mathbf{x}_{i,\cdot},\boldsymbol\beta)
+ (1-y_i) \log(1-\Pr(Y=1|\mathbf{x}_{i,\cdot},\boldsymbol\beta))
\]</span></p>
<p>Taking into account that:</p>
<p><span class="math display">\[
\Pr(Y=1|\mathbf{x}_{i,\cdot},\boldsymbol\beta)=
\frac{1}{1+e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}},
\]</span></p>
<p>we get:</p>
<p><span class="math display">\[
E(\boldsymbol\beta)=
-\frac{1}{n}
\sum_{i=1}^n \left(
\begin{array}{r}
y_i \log \displaystyle\frac{1}{1+e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}}\\
+
(1-y_i) \log \displaystyle\frac{e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}}{1+e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}}
\end{array}
\right).
\]</span></p>
<p>Logarithms are really practitioner-friendly functions,
it holds:</p>
<ul>
<li><span class="math inline">\(\log 1=0\)</span>,</li>
<li><span class="math inline">\(\log e=1\)</span> (where <span class="math inline">\(e \simeq 2.71828\)</span> is the Euler constant;
note that by writing <span class="math inline">\(\log\)</span> we mean the natural a.k.a. base-<span class="math inline">\(e\)</span> logarithm),</li>
<li><span class="math inline">\(\log xy = \log x + \log y\)</span>,</li>
<li><span class="math inline">\(\log x^p = p\log x\)</span> (this is <span class="math inline">\(\log (x^p)\)</span>, not <span class="math inline">\((\log x)^p\)</span>).</li>
</ul>
<p>These facts imply, amongst others that:</p>
<ul>
<li><span class="math inline">\(\log e^x = x \log e = x\)</span>,</li>
<li><span class="math inline">\(\log \frac{x}{y} = \log x y^{-1} = \log x+\log y^{-1} = \log x - \log y\)</span>
(of course for <span class="math inline">\(y\neq 0\)</span>),</li>
<li><span class="math inline">\(\log \frac{1}{y} = -\log y\)</span></li>
</ul>
<p>and so forth. Therefore,
based on the fact that
<span class="math inline">\(1/(1+e^{-x})=e^x/(1+e^x)\)</span>,
the above optimisation problem can be rewritten as:</p>
<p><span class="math display">\[
E(\boldsymbol\beta)=
\frac{1}{n}
\sum_{i=1}^n \left(
\begin{array}{r}
y_i \log \left(1+e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}\right)\\
+
(1-y_i) \log \left(1+e^{+(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}\right)
\end{array}
\right)
\]</span></p>
<p>or, if someone prefers:</p>
<p><span class="math display">\[
E(\boldsymbol\beta)=
\frac{1}{n}
\sum_{i=1}^n \left(
(1-y_i)\left(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p}\right)
+\log \left(1+e^{-(\beta_0 + \beta_1 x_{i,1}+\dots+\beta_p x_{i,p})}\right)
\right).
\]</span></p>
<p>It turns out that there is no analytical formula
for the optimal set of parameters (<span class="math inline">\(\beta_0,\beta_1,\dots,\beta_p\)</span>
minimising the log-loss).
In the chapter on optimisation, we shall see that
the solution to the logistic regression can be solved numerically
by means of quite simple iterative algorithms.
The two expanded formulae have lost the appealing interpretation
of the original one, however, it’s more numerically well-behaving,
see, e.g., the <code>log1p()</code> function in base R or, even better,
<code>fermi_dirac_0()</code> in the <code>gsl</code> package.</p>
<!-- TODO: cite Goldberg's paper -->
</div>
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">6.3</span> Exercises</h2>
<div id="edstats-fitting-of-binary-logistic-regression-models" class="section level3">
<h3><span class="header-section-number">6.3.1</span> EdStats – Fitting of Binary Logistic Regression Models</h3>
<p>In this task we’re going to
consider the “wide” version of the EdStats
dataset again:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" title="1">edstats &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;datasets/edstats_2019_wide.csv&quot;</span>,</a>
<a class="sourceLine" id="cb491-2" title="2">    <span class="dt">comment.char=</span><span class="st">&quot;#&quot;</span>)</a></code></pre></div>
<p>Let’s re-add the <code>girls_rule_maths</code> column
just as in the previous exercise.
Then, let’s create a subset of <code>edstats</code> that doesn’t include
the country names as well as the boys’ and girls’ math scores.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1">edstats<span class="op">$</span>girls_rule_maths &lt;-</a>
<a class="sourceLine" id="cb492-2" title="2"><span class="st">    </span><span class="kw">factor</span>(<span class="kw">as.numeric</span>(</a>
<a class="sourceLine" id="cb492-3" title="3">        edstats<span class="op">$</span>LO.PISA.MAT.FE<span class="op">&gt;</span>edstats<span class="op">$</span>LO.PISA.MAT.MA</a>
<a class="sourceLine" id="cb492-4" title="4">    ))</a>
<a class="sourceLine" id="cb492-5" title="5">edstats_subset &lt;-<span class="st"> </span>edstats[<span class="op">!</span>(<span class="kw">names</span>(edstats) <span class="op">%in%</span></a>
<a class="sourceLine" id="cb492-6" title="6"><span class="st">    </span><span class="kw">c</span>(<span class="st">&quot;CountryName&quot;</span>, <span class="st">&quot;LO.PISA.MAT.FE&quot;</span>, <span class="st">&quot;LO.PISA.MAT.MA&quot;</span>))]</a></code></pre></div>
<div class="exercise"><strong>Exercise.</strong>
<p>Fit and assess a logistic regression model for <code>girls_rule_maths</code> as a function
of <code>LO.PISA.REA.MA</code>+<code>LO.PISA.SCI</code>.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>Fitting of the model:</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb493-1" title="1">(f1 &lt;-<span class="st"> </span><span class="kw">glm</span>(girls_rule_maths<span class="op">~</span>LO.PISA.REA.MA<span class="op">+</span>LO.PISA.SCI,</a>
<a class="sourceLine" id="cb493-2" title="2">    <span class="dt">data=</span>edstats_subset, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)))</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = girls_rule_maths ~ LO.PISA.REA.MA + LO.PISA.SCI, 
##     family = binomial(&quot;logit&quot;), data = edstats_subset)
## 
## Coefficients:
##    (Intercept)  LO.PISA.REA.MA     LO.PISA.SCI  
##         3.0927         -0.0882          0.0755  
## 
## Degrees of Freedom: 80 Total (i.e. Null);  78 Residual
##   (187 observations deleted due to missingness)
## Null Deviance:       103 
## Residual Deviance: 77.9  AIC: 83.9</code></pre>
<p>Performance metrics:</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f1, edstats_subset, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb495-2" title="2"><span class="kw">get_metrics</span>(Y_pred, edstats_subset<span class="op">$</span>girls_rule_maths)</a></code></pre></div>
<pre><code>##      Acc     Prec      Rec        F       TN       FN       FP       TP 
##  0.79012  0.75000  0.55556  0.63830 49.00000 12.00000  5.00000 15.00000</code></pre>
<p>Relate the above numbers to those reported for the fitted decision trees.</p>
<p>Note that the fitted model is nicely interpretable:
the lower the boys’ average result on the Reading Scale
or the higher the country’s result on the Science Scale,
the higher the probability for <code>girls_rule_maths</code>:</p>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb497-1" title="1">example_X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb497-2" title="2">    <span class="dt">LO.PISA.REA.MA=</span><span class="kw">c</span>(<span class="dv">475</span>, <span class="dv">450</span>, <span class="dv">475</span>, <span class="dv">500</span>),</a>
<a class="sourceLine" id="cb497-3" title="3">    <span class="dt">LO.PISA.SCI=</span>   <span class="kw">c</span>(<span class="dv">525</span>, <span class="dv">525</span>, <span class="dv">550</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb497-4" title="4">)</a>
<a class="sourceLine" id="cb497-5" title="5"><span class="kw">cbind</span>(example_X,</a>
<a class="sourceLine" id="cb497-6" title="6">    <span class="st">`</span><span class="dt">Pr(Y=1)</span><span class="st">`</span>=<span class="kw">predict</span>(f1, example_X, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>))</a></code></pre></div>
<pre><code>##   LO.PISA.REA.MA LO.PISA.SCI  Pr(Y=1)
## 1            475         525 0.703342
## 2            450         525 0.955526
## 3            475         550 0.939986
## 4            500         500 0.038094</code></pre>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>(*) Fit and assess a logistic regression model for <code>girls_rule_maths</code>
featuring all <code>LO.PISA.REA*</code> and <code>LO.PISA.SCI*</code> as independent variables.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>Model fitting:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb499-1" title="1">(f2 &lt;-<span class="st"> </span><span class="kw">glm</span>(girls_rule_maths<span class="op">~</span>LO.PISA.REA<span class="op">+</span>LO.PISA.REA.FE<span class="op">+</span>LO.PISA.REA.MA<span class="op">+</span></a>
<a class="sourceLine" id="cb499-2" title="2"><span class="st">                            </span>LO.PISA.SCI<span class="op">+</span>LO.PISA.SCI.FE<span class="op">+</span>LO.PISA.SCI.MA,</a>
<a class="sourceLine" id="cb499-3" title="3">    <span class="dt">data=</span>edstats_subset, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)))</a></code></pre></div>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<pre><code>## 
## Call:  glm(formula = girls_rule_maths ~ LO.PISA.REA + LO.PISA.REA.FE + 
##     LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + LO.PISA.SCI.MA, 
##     family = binomial(&quot;logit&quot;), data = edstats_subset)
## 
## Coefficients:
##    (Intercept)     LO.PISA.REA  LO.PISA.REA.FE  LO.PISA.REA.MA  
##         -2.265           1.268          -0.544          -0.734  
##    LO.PISA.SCI  LO.PISA.SCI.FE  LO.PISA.SCI.MA  
##          1.269          -0.157          -1.112  
## 
## Degrees of Freedom: 80 Total (i.e. Null);  74 Residual
##   (187 observations deleted due to missingness)
## Null Deviance:       103 
## Residual Deviance: 33    AIC: 47</code></pre>
<p>The mysterious <code>fitted probabilities numerically 0 or 1 occurred</code> warning
denotes convergence problems of the underlying optimisation (fitting) procedure:
at least one of the model coefficients has had a fairly large order
of magnitude and hence the fitted probabilities has come very close to 0 or 1.
Recall that the probabilities are modelled by means of the logistic sigmoid
function applied on the output of a linear combination of the dependent variables.
Moreover, cross-entropy features a logarithm, and <span class="math inline">\(\log 0 = -\infty\)</span>.</p>
<p>This can be due to the fact that all the variables in the model are very
correlated with each other (multicollinearity; an ill-conditioned problem).
The obtained solution might be unstable – there might be many local optima
and hence, different parameter vectors might be equally good.
Moreover, it is likely that a small change in one of the inputs might
lead to large change in the estimated model
(* normally, we would attack this problem by employing
some regularisation techniques).</p>
<!--
#(f2 <- glm(girls_rule_maths~LO.PISA.REA+LO.PISA.REA.FE+LO.PISA.REA.MA+
#                            LO.PISA.SCI+LO.PISA.SCI.FE+LO.PISA.SCI.MA,
#    data=edstats_subset, family=binomial("logit"), start=runif(7,-0.1,0.1)))
-->
<p>Of course, the model’s performance metrics can still be computed,
but then it’s better if we treat it as a black box. Or, even better,
reduce the number of independent variables and come up with a simpler
model that serves its purpose better than this one.</p>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f2, edstats_subset, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb502-2" title="2"><span class="kw">get_metrics</span>(Y_pred, edstats_subset<span class="op">$</span>girls_rule_maths)</a></code></pre></div>
<pre><code>##      Acc     Prec      Rec        F       TN       FN       FP       TP 
##  0.86420  0.83333  0.74074  0.78431 50.00000  7.00000  4.00000 20.00000</code></pre>
</details>
<!--

standardise variables:  [too little benefit for the reader? omit]


```r
#standardise <- function(x) {
#    (x-mean(x, na.rm=TRUE))/sd(x, na.rm=TRUE)
#}
```


```r
#sedstats_subset <- edstats_subset # copy
#for (i in 1:(ncol(sedstats_subset)-1)) {
#    # standardise every column of sedstats_subset but
#    # the girls_rule_maths one (it must remain a binary==0/1 variable)
#    sedstats_subset[[i]] <- standardise(sedstats_subset[[i]])
#}
```


```r
#(f1s <- glm(girls_rule_maths~LO.PISA.REA.MA+LO.PISA.SCI,
#    data=sedstats_subset, family=binomial("logit")))
#Y_pred <- as.numeric(predict(f1s, sedstats_subset, type="response")>0.5)
#get_metrics(Y_pred, sedstats_subset$girls_rule_maths)
```


```r
#(f2s <- glm(girls_rule_maths~LO.PISA.REA+LO.PISA.REA.FE+LO.PISA.REA.MA+
#                            LO.PISA.SCI+LO.PISA.SCI.FE+LO.PISA.SCI.MA,
#    data=sedstats_subset, family=binomial("logit")))
#Y_pred <- as.numeric(predict(f2s, sedstats_subset, type="response")>0.5)
#get_metrics(Y_pred, sedstats_subset$girls_rule_maths)
```

-->
</div>
<div id="edstats-variable-selection-in-binary-logistic-regression" class="section level3">
<h3><span class="header-section-number">6.3.2</span> EdStats – Variable Selection in Binary Logistic Regression (*)</h3>
<p>Back to our <code>girls_rule_maths</code> example, we still have so much to learn!</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" title="1">edstats &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;datasets/edstats_2019_wide.csv&quot;</span>,</a>
<a class="sourceLine" id="cb504-2" title="2">    <span class="dt">comment.char=</span><span class="st">&quot;#&quot;</span>)</a>
<a class="sourceLine" id="cb504-3" title="3">edstats<span class="op">$</span>girls_rule_maths &lt;-</a>
<a class="sourceLine" id="cb504-4" title="4"><span class="st">    </span><span class="kw">factor</span>(<span class="kw">as.numeric</span>(</a>
<a class="sourceLine" id="cb504-5" title="5">        edstats<span class="op">$</span>LO.PISA.MAT.FE<span class="op">&gt;</span>edstats<span class="op">$</span>LO.PISA.MAT.MA</a>
<a class="sourceLine" id="cb504-6" title="6">    ))</a>
<a class="sourceLine" id="cb504-7" title="7">edstats_subset &lt;-<span class="st"> </span>edstats[<span class="op">!</span>(<span class="kw">names</span>(edstats) <span class="op">%in%</span></a>
<a class="sourceLine" id="cb504-8" title="8"><span class="st">    </span><span class="kw">c</span>(<span class="st">&quot;CountryName&quot;</span>, <span class="st">&quot;LO.PISA.MAT.FE&quot;</span>, <span class="st">&quot;LO.PISA.MAT.MA&quot;</span>))]</a></code></pre></div>
<div class="exercise"><strong>Exercise.</strong>
<p>Construct a binary logistic regression model via forward selection
of variables.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>Just as in the linear regression case, we can rely on the <code>step()</code> function.</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" title="1">model_empty &lt;-<span class="st"> </span>girls_rule_maths<span class="op">~</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb505-2" title="2">(model_full &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">model.frame</span>(girls_rule_maths<span class="op">~</span>.,</a>
<a class="sourceLine" id="cb505-3" title="3">    <span class="dt">data=</span>edstats_subset)))</a></code></pre></div>
<pre><code>## girls_rule_maths ~ HD.HCI.AMRT + HD.HCI.AMRT.FE + HD.HCI.AMRT.MA + 
##     HD.HCI.EYRS + HD.HCI.EYRS.FE + HD.HCI.EYRS.MA + HD.HCI.HLOS + 
##     HD.HCI.HLOS.FE + HD.HCI.HLOS.MA + HD.HCI.MORT + HD.HCI.MORT.FE + 
##     HD.HCI.MORT.MA + HD.HCI.OVRL + HD.HCI.OVRL.FE + HD.HCI.OVRL.MA + 
##     IT.CMP.PCMP.P2 + IT.NET.USER.P2 + LO.PISA.MAT + LO.PISA.REA + 
##     LO.PISA.REA.FE + LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + 
##     LO.PISA.SCI.MA + NY.GDP.MKTP.CD + NY.GDP.PCAP.CD + NY.GDP.PCAP.PP.CD + 
##     NY.GNP.PCAP.CD + NY.GNP.PCAP.PP.CD + SE.COM.DURS + SE.PRM.CMPT.FE.ZS + 
##     SE.PRM.CMPT.MA.ZS + SE.PRM.CMPT.ZS + SE.PRM.ENRL.TC.ZS + 
##     SE.PRM.ENRR + SE.PRM.ENRR.FE + SE.PRM.ENRR.MA + SE.PRM.NENR + 
##     SE.PRM.NENR.FE + SE.PRM.NENR.MA + SE.PRM.PRIV.ZS + SE.SEC.ENRL.TC.ZS + 
##     SE.SEC.ENRR + SE.SEC.ENRR.FE + SE.SEC.ENRR.MA + SE.SEC.NENR + 
##     SE.SEC.NENR.MA + SE.SEC.PRIV.ZS + SE.TER.ENRR + SE.TER.ENRR.FE + 
##     SE.TER.ENRR.MA + SE.TER.PRIV.ZS + SE.XPD.TOTL.GD.ZS + SL.TLF.ADVN.FE.ZS + 
##     SL.TLF.ADVN.MA.ZS + SL.TLF.ADVN.ZS + SP.POP.TOTL + SP.POP.TOTL.FE.IN + 
##     SP.POP.TOTL.MA.IN + SP.PRM.TOTL.FE.IN + SP.PRM.TOTL.IN + 
##     SP.PRM.TOTL.MA.IN + SP.SEC.TOTL.FE.IN + SP.SEC.TOTL.IN + 
##     SP.SEC.TOTL.MA.IN + UIS.PTRHC.56 + UIS.SAP.CE + UIS.SAP.CE.F + 
##     UIS.SAP.CE.M + UIS.X.PPP.1.FSGOV + UIS.X.PPP.2T3.FSGOV + 
##     UIS.X.PPP.5T8.FSGOV + UIS.X.US.1.FSGOV + UIS.X.US.2T3.FSGOV + 
##     UIS.X.US.5T8.FSGOV + UIS.XGDP.1.FSGOV + UIS.XGDP.23.FSGOV + 
##     UIS.XGDP.56.FSGOV + UIS.XUNIT.GDPCAP.1.FSGOV + UIS.XUNIT.GDPCAP.23.FSGOV + 
##     UIS.XUNIT.GDPCAP.5T8.FSGOV + UIS.XUNIT.PPP.1.FSGOV.FFNTR + 
##     UIS.XUNIT.PPP.2T3.FSGOV.FFNTR + UIS.XUNIT.PPP.5T8.FSGOV.FFNTR + 
##     UIS.XUNIT.US.1.FSGOV.FFNTR + UIS.XUNIT.US.23.FSGOV.FFNTR + 
##     UIS.XUNIT.US.5T8.FSGOV.FFNTR</code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" title="1">f &lt;-<span class="st"> </span><span class="kw">step</span>(<span class="kw">glm</span>(model_empty, <span class="dt">data=</span>edstats_subset, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)),</a>
<a class="sourceLine" id="cb507-2" title="2">    <span class="dt">scope=</span>model_full, <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=105.12
## girls_rule_maths ~ 1</code></pre>
<pre><code>## Error in model.matrix.default(Terms, m, contrasts.arg = object$contrasts): variable 1 has no levels</code></pre>
<p>Melbourne, we have a problem!
Our dataset has too many missing values, and those cannot be present
in a logistic regression model (it’s based on a linear combination of variables,
and sums/products involving <code>NA</code>s yield <code>NA</code>s…).</p>
<p>Looking at the manual of <code>?step</code>, we see that the default
<code>NA</code> handling is via <code>na.omit()</code>, and that, when applied on a data frame,
results in the removal of all the <em>rows</em>, where there is at least one <code>NA</code>.
Sadly, it’s too invasive.</p>
<p>We should get rid of the data blanks manually.
First, definitely, we should remove all the rows where
<code>girls_rule_maths</code> is unknown:</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1">edstats_subset &lt;-</a>
<a class="sourceLine" id="cb510-2" title="2"><span class="st">    </span>edstats_subset[<span class="op">!</span><span class="kw">is.na</span>(edstats_subset<span class="op">$</span>girls_rule_maths),]</a></code></pre></div>
<p>We are about to apply the forward selection process, whose purpose is
to choose variables for a model. Therefore, instead of removing any more
rows, we should remove the… columns with missing data:</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" title="1">edstats_subset &lt;-</a>
<a class="sourceLine" id="cb511-2" title="2"><span class="st">    </span>edstats_subset[,<span class="kw">colSums</span>(<span class="kw">sapply</span>(edstats_subset, is.na))<span class="op">==</span><span class="dv">0</span>]</a></code></pre></div>
<p>(*) Alternatively, we could apply some techniques of missing data imputation;
this is beyond the scope of this book. For instance, <code>NA</code>s could be
replaced by the averages of their respective columns.</p>
<p>We are ready now to make use of <code>step()</code>.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1">model_empty &lt;-<span class="st"> </span>girls_rule_maths<span class="op">~</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb512-2" title="2">(model_full &lt;-<span class="st"> </span><span class="kw">formula</span>(<span class="kw">model.frame</span>(girls_rule_maths<span class="op">~</span>.,</a>
<a class="sourceLine" id="cb512-3" title="3">    <span class="dt">data=</span>edstats_subset)))</a></code></pre></div>
<pre><code>## girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.MAT + LO.PISA.REA + 
##     LO.PISA.REA.FE + LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + 
##     LO.PISA.SCI.MA + NY.GDP.MKTP.CD + NY.GDP.PCAP.CD + SP.POP.TOTL</code></pre>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" title="1">f &lt;-<span class="st"> </span><span class="kw">step</span>(<span class="kw">glm</span>(model_empty, <span class="dt">data=</span>edstats_subset, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)),</a>
<a class="sourceLine" id="cb514-2" title="2">    <span class="dt">scope=</span>model_full, <span class="dt">direction=</span><span class="st">&quot;forward&quot;</span>)</a></code></pre></div>
<pre><code>## Start:  AIC=105.12
## girls_rule_maths ~ 1
## 
##                  Df Deviance   AIC
## + LO.PISA.REA.MA  1     90.9  94.9
## + LO.PISA.SCI.MA  1     93.3  97.3
## + NY.GDP.MKTP.CD  1     94.2  98.2
## + LO.PISA.REA     1     95.0  99.0
## + LO.PISA.SCI     1     96.9 100.9
## + LO.PISA.MAT     1     97.2 101.2
## + LO.PISA.REA.FE  1     97.9 101.9
## + LO.PISA.SCI.FE  1     99.4 103.4
## &lt;none&gt;                 103.1 105.1
## + SP.POP.TOTL     1    101.9 105.9
## + NY.GDP.PCAP.CD  1    102.3 106.3
## + IT.NET.USER.P2  1    103.1 107.1
## 
## Step:  AIC=94.93
## girls_rule_maths ~ LO.PISA.REA.MA
## 
##                  Df Deviance  AIC
## + LO.PISA.REA     1     42.8 48.8
## + LO.PISA.REA.FE  1     50.5 56.5
## + LO.PISA.SCI.FE  1     65.4 71.4
## + LO.PISA.SCI     1     77.9 83.9
## + LO.PISA.MAT     1     83.5 89.5
## + NY.GDP.MKTP.CD  1     87.4 93.4
## + IT.NET.USER.P2  1     87.5 93.5
## &lt;none&gt;                  90.9 94.9
## + NY.GDP.PCAP.CD  1     89.2 95.2
## + LO.PISA.SCI.MA  1     89.2 95.2
## + SP.POP.TOTL     1     90.2 96.2
## 
## Step:  AIC=48.83
## girls_rule_maths ~ LO.PISA.REA.MA + LO.PISA.REA
## 
##                  Df Deviance  AIC
## &lt;none&gt;                  42.8 48.8
## + LO.PISA.SCI.FE  1     40.9 48.9
## + SP.POP.TOTL     1     41.2 49.2
## + NY.GDP.PCAP.CD  1     41.3 49.3
## + LO.PISA.SCI     1     42.0 50.0
## + LO.PISA.MAT     1     42.4 50.4
## + IT.NET.USER.P2  1     42.7 50.7
## + LO.PISA.SCI.MA  1     42.7 50.7
## + NY.GDP.MKTP.CD  1     42.7 50.7
## + LO.PISA.REA.FE  1     42.8 50.8</code></pre>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" title="1"><span class="kw">print</span>(f)</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = girls_rule_maths ~ LO.PISA.REA.MA + LO.PISA.REA, 
##     family = binomial(&quot;logit&quot;), data = edstats_subset)
## 
## Coefficients:
##    (Intercept)  LO.PISA.REA.MA     LO.PISA.REA  
##         -0.176          -0.600           0.577  
## 
## Degrees of Freedom: 80 Total (i.e. Null);  78 Residual
## Null Deviance:       103 
## Residual Deviance: 42.8  AIC: 48.8</code></pre>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb518-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f, edstats_subset, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb518-2" title="2"><span class="kw">get_metrics</span>(Y_pred, edstats_subset<span class="op">$</span>girls_rule_maths)</a></code></pre></div>
<pre><code>##      Acc     Prec      Rec        F       TN       FN       FP       TP 
##  0.88889  0.84615  0.81481  0.83019 50.00000  5.00000  4.00000 22.00000</code></pre>
</details>
<div class="exercise"><strong>Exercise.</strong>
<p>Choose a model via backward elimination.</p>
</div>
<details class="solution"><summary style="color: blue">Click here for a solution.</summary>
<p>Having a dataset with missing values removed, this is easy now:</p>
<!--
makes no difference:

# standardise <- function(x) {
#     (x-mean(x, na.rm=TRUE))/sd(x, na.rm=TRUE)
# }
# for (i in 1:(ncol(edstats_subset)-1)) {
#    # standardise every column of sedstats_subset but
#    # the girls_rule_maths one (it must remain a binary==0/1 variable)
#    edstats_subset[[i]] <- standardise(edstats_subset[[i]])
# }
-->
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb520-1" title="1">f &lt;-<span class="st"> </span><span class="kw">suppressWarnings</span>( <span class="co"># yeah, yeah, yeah...</span></a>
<a class="sourceLine" id="cb520-2" title="2">        <span class="co"># fitted probabilities numerically 0 or 1 occurred</span></a>
<a class="sourceLine" id="cb520-3" title="3">    <span class="kw">step</span>(<span class="kw">glm</span>(model_full, <span class="dt">data=</span>edstats_subset, <span class="dt">family=</span><span class="kw">binomial</span>(<span class="st">&quot;logit&quot;</span>)),</a>
<a class="sourceLine" id="cb520-4" title="4">        <span class="dt">scope=</span>model_empty, <span class="dt">direction=</span><span class="st">&quot;backward&quot;</span>)</a>
<a class="sourceLine" id="cb520-5" title="5">)</a></code></pre></div>
<pre><code>## Start:  AIC=50.83
## girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.MAT + LO.PISA.REA + 
##     LO.PISA.REA.FE + LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + 
##     LO.PISA.SCI.MA + NY.GDP.MKTP.CD + NY.GDP.PCAP.CD + SP.POP.TOTL
## 
##                  Df Deviance  AIC
## - LO.PISA.MAT     1     26.8 48.8
## - LO.PISA.SCI.MA  1     26.8 48.8
## - NY.GDP.PCAP.CD  1     26.9 48.9
## - LO.PISA.SCI     1     26.9 48.9
## - LO.PISA.SCI.FE  1     27.1 49.1
## - LO.PISA.REA.FE  1     27.4 49.4
## - LO.PISA.REA     1     27.5 49.5
## - LO.PISA.REA.MA  1     27.6 49.6
## &lt;none&gt;                  26.8 50.8
## - IT.NET.USER.P2  1     29.3 51.3
## - NY.GDP.MKTP.CD  1     29.9 51.9
## - SP.POP.TOTL     1     31.7 53.7
## 
## Step:  AIC=48.84
## girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.REA + LO.PISA.REA.FE + 
##     LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + LO.PISA.SCI.MA + 
##     NY.GDP.MKTP.CD + NY.GDP.PCAP.CD + SP.POP.TOTL
## 
##                  Df Deviance  AIC
## - LO.PISA.SCI.MA  1     26.8 46.8
## - NY.GDP.PCAP.CD  1     26.9 46.9
## - LO.PISA.SCI     1     27.0 47.0
## - LO.PISA.SCI.FE  1     27.1 47.1
## - LO.PISA.REA.FE  1     27.4 47.4
## - LO.PISA.REA     1     27.5 47.5
## - LO.PISA.REA.MA  1     27.6 47.6
## &lt;none&gt;                  26.8 48.8
## - IT.NET.USER.P2  1     29.3 49.3
## - NY.GDP.MKTP.CD  1     29.9 49.9
## - SP.POP.TOTL     1     31.7 51.7
## 
## Step:  AIC=46.84
## girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.REA + LO.PISA.REA.FE + 
##     LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + NY.GDP.MKTP.CD + 
##     NY.GDP.PCAP.CD + SP.POP.TOTL
## 
##                  Df Deviance  AIC
## - NY.GDP.PCAP.CD  1     26.9 44.9
## &lt;none&gt;                  26.8 46.8
## - IT.NET.USER.P2  1     29.3 47.3
## - NY.GDP.MKTP.CD  1     29.9 47.9
## - LO.PISA.REA.FE  1     31.0 49.0
## - SP.POP.TOTL     1     31.8 49.8
## - LO.PISA.SCI     1     35.6 53.6
## - LO.PISA.SCI.FE  1     36.1 54.1
## - LO.PISA.REA     1     37.5 55.5
## - LO.PISA.REA.MA  1     50.9 68.9
## 
## Step:  AIC=44.87
## girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.REA + LO.PISA.REA.FE + 
##     LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + NY.GDP.MKTP.CD + 
##     SP.POP.TOTL
## 
##                  Df Deviance  AIC
## &lt;none&gt;                  26.9 44.9
## - NY.GDP.MKTP.CD  1     30.5 46.5
## - IT.NET.USER.P2  1     31.0 47.0
## - LO.PISA.REA.FE  1     31.1 47.1
## - SP.POP.TOTL     1     33.0 49.0
## - LO.PISA.SCI     1     35.9 51.9
## - LO.PISA.SCI.FE  1     36.4 52.4
## - LO.PISA.REA     1     37.5 53.5
## - LO.PISA.REA.MA  1     50.9 66.9</code></pre>
<p>The obtained model and its quality metrics:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" title="1"><span class="kw">print</span>(f)</a></code></pre></div>
<pre><code>## 
## Call:  glm(formula = girls_rule_maths ~ IT.NET.USER.P2 + LO.PISA.REA + 
##     LO.PISA.REA.FE + LO.PISA.REA.MA + LO.PISA.SCI + LO.PISA.SCI.FE + 
##     NY.GDP.MKTP.CD + SP.POP.TOTL, family = binomial(&quot;logit&quot;), 
##     data = edstats_subset)
## 
## Coefficients:
##    (Intercept)  IT.NET.USER.P2     LO.PISA.REA  LO.PISA.REA.FE  
##      -1.66e+01        1.61e-01        1.85e+00       -8.00e-01  
## LO.PISA.REA.MA     LO.PISA.SCI  LO.PISA.SCI.FE  NY.GDP.MKTP.CD  
##      -1.03e+00       -1.35e+00        1.32e+00       -4.95e-12  
##    SP.POP.TOTL  
##       6.20e-08  
## 
## Degrees of Freedom: 80 Total (i.e. Null);  72 Residual
## Null Deviance:       103 
## Residual Deviance: 26.9  AIC: 44.9</code></pre>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" title="1">Y_pred &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">predict</span>(f, edstats_subset, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb524-2" title="2"><span class="kw">get_metrics</span>(Y_pred, edstats_subset<span class="op">$</span>girls_rule_maths)</a></code></pre></div>
<pre><code>##      Acc     Prec      Rec        F       TN       FN       FP       TP 
##  0.91358  0.88462  0.85185  0.86792 51.00000  4.00000  3.00000 23.00000</code></pre>
<p>Note that we got a better (lower) AIC than in the forward selection
case, which means that backward elimination was better this time.
On the other hand, we needed to suppress the
<code>fitted probabilities numerically 0 or 1 occurred</code> warnings.
The returned model is perhaps <em>unstable</em> as well and consists of too
many variables.</p>
</details>
</div>
<div id="currency-exchange-rates-growthfall" class="section level3">
<h3><span class="header-section-number">6.3.3</span> Currency Exchange Rates Growth/Fall</h3>
<p>Let’s consider a modified version of the Currency Exchange Rates
dataset released by the European Central Bank System:</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" title="1">currency_exchange &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;datasets/currency_exchange_diff.csv.gz&quot;</span>,</a>
<a class="sourceLine" id="cb526-2" title="2">    <span class="dt">comment.char=</span><span class="st">&quot;#&quot;</span>)</a>
<a class="sourceLine" id="cb526-3" title="3"><span class="kw">head</span>(currency_exchange[,<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]) <span class="co"># few first rows and columns</span></a></code></pre></div>
<pre><code>##          Day    AUD  Change  Dir    Lag1    Lag2    Lag3    Lag4
## 1 1999-01-04 1.9100      NA &lt;NA&gt;      NA      NA      NA      NA
## 2 1999-01-05 1.8944 -0.0156  dec      NA      NA      NA      NA
## 3 1999-01-06 1.8820 -0.0124  dec -0.0156      NA      NA      NA
## 4 1999-01-07 1.8474 -0.0346  dec -0.0124 -0.0156      NA      NA
## 5 1999-01-08 1.8406 -0.0068  dec -0.0346 -0.0124 -0.0156      NA
## 6 1999-01-11 1.8134 -0.0272  dec -0.0068 -0.0346 -0.0124 -0.0156</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" title="1"><span class="kw">tail</span>(currency_exchange[,<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]) <span class="co"># a couple of last rows and a few columns</span></a></code></pre></div>
<pre><code>##             Day    AUD  Change Dir    Lag1    Lag2    Lag3    Lag4
## 5528 2020-05-12 1.6625 -0.0084 dec  0.0096 -0.0091 -0.0342  0.0221
## 5529 2020-05-13 1.6687  0.0062 inc -0.0084  0.0096 -0.0091 -0.0342
## 5530 2020-05-14 1.6805  0.0118 inc  0.0062 -0.0084  0.0096 -0.0091
## 5531 2020-05-15 1.6805  0.0000 dec  0.0118  0.0062 -0.0084  0.0096
## 5532 2020-05-18 1.6736 -0.0069 dec  0.0000  0.0118  0.0062 -0.0084
## 5533 2020-05-19 1.6751  0.0015 inc -0.0069  0.0000  0.0118  0.0062</code></pre>
<p>We have discussed this dataset in Appendix F. <!-- TODO: -->
We will investigate how accurately we can predict if
the EUR/AUD exchange rate increases (<code>Dir</code> equal to <code>inc</code>)
or decreases (<code>Dir</code> equal to <code>dec</code>) based on the price changes
in preceding days (<code>Lag1</code> – yesterday, <code>Lag2</code> – two days ago etc.).</p>
<div class="exercise"><strong>Exercise.</strong>
<p>Perform a train-test split. Create a
data frame <code>currency_exchange_train</code> that consists of the <em>first</em> 80% rows
in <code>currency_exchange</code> and a data frame <code>currency_exchange_test</code>
that includes the remaining 20%.</p>
</div>
<dl>
<dt>Remark.</dt>
<dd><p>This is a time series prediction task;
we are not assigning the observations to either of these two subsets in
a random manner. Instead, we use the “past” data for training (models’ construction)
and the “future” values for testing (models’ performance evaluation).
This is exactly how we often proceed in real life.</p>
</dd>
</dl>
<div class="exercise"><strong>Exercise.</strong>
<p>Fit and plot a decision tree that models <code>Dir</code> as a function
of <code>Lag1</code>, …, <code>Lag5</code>. Compute the accuracy, precision, recall
and F-measure of this classifier.</p>
</div>
<div class="exercise"><strong>Exercise.</strong>
<p>Fit 5 binary logistic regression models for <code>Dir</code> as a function of
the percentage return from: (i) the previous day, (ii) the last three days,
(iii) five days, (iv) seven days, (v) all the previous 10 days.
Print the estimated coefficients (parameters). Evaluate
the performance of these 5 classifiers.</p>
</div>
<div class="exercise"><strong>Exercise.</strong>
<p>Use the 5- and 15-nearest neighbours algorithm
to predict <code>Dir</code> based on the percentage returns from the 5 previous days.
Evaluate the performance of these 2 classifiers.</p>
</div>
<div class="exercise"><strong>Exercise.</strong>
<p>Discuss the obtained results. Would you be keen to use any of the
constructed classifiers for making real money?</p>
</div>
</div>
</div>
<div id="outro-4" class="section level2">
<h2><span class="header-section-number">6.4</span> Outro</h2>
<div id="remarks-4" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Remarks</h3>
<p>Other prominent classification algorithms:</p>
<ul>
<li>Naive Bayes and other probabilistic approaches,</li>
<li>Support Vector Machines (SVMs) and other kernel methods,</li>
<li>(Artificial) (Deep) Neural Networks.</li>
</ul>
<p>Interestingly, in the next chapter we will note that the logistic regression model
is a special case of a <em>feed-forward single layer neural network</em>.</p>
<p>We will also generalise the binary logistic regression to the case of
a multiclass classification.</p>
<p>The state-of-the art classifiers called
<em>Random Forests</em> and <em>XGBoost</em> (see also: <em>AdaBoost</em>) are based on decision trees.
They tend to be more accurate but – at the same time – they fail to
exhibit the decision trees’ important feature: interpretability.</p>
<p>Trees can also be used for regression tasks, see R package <code>rpart</code>.</p>
</div>
<div id="further-reading-4" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Further Reading</h3>
<p>Recommended further reading: <span class="citation">(James et al. <a href="references.html#ref-islr">2017</a>: Chapters 4 and 8)</span> <!-- TODO: update --></p>
<p>Other: <span class="citation">(Hastie et al. <a href="references.html#ref-esl">2017</a>: Chapters 4 and 7 as well as (*) Chapters 9, 10, 13, 15)</span></p>
<!-- TODO: update -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="continuous-optimisation-with-iterative-algorithms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "serif",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": "lmlcr.pdf",
"toc": {
"collapse": "subsection",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
